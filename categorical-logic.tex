\documentclass[article,10pt,oneside]{memoir}
\input{preambles}
\title{categorical logic}
\author{Frank Tsai}
\date{\today}
%\thanks{}
\begin{document}
\maketitle
\tableofcontents

\section{Introduction}
\label{sec:introduction}

The categorification of algebraic theories enabled us to investigate these theories in a presentation-invariant way.
Algebraic theories are precisely categories with finite products.
We think of the objects of such a category as sorts and morphisms as terms.
Equations are internalized as the diagonal subobjects.
Given two algebraic theories $\cT$ and $\cT'$, a model of $\cT$ in $\cT'$ is a finite-product preserving functor $M : \cT \to \cT'$, ensuring that products of sorts in $\cT$ are interpreted (sensibly) as products of sorts in $\cT'$.
Additionally, this also ensures that equations are preserved.
Unsurprisingly, a homomorphism from $M$ to $M'$ is precisely a natural transformation $\alpha : M \To M'$.
% https://q.uiver.app/#q=WzAsNCxbMiwwLCJNcyJdLFswLDIsIk1zIl0sWzIsMiwiTShzIFxcdGltZXMgcykiXSxbNCwyLCJNKHMpIl0sWzIsMSwiXFxwaV97MX0iXSxbMiwzLCJcXHBpX3syfSIsMl0sWzAsMSwiXFxpZCIsMl0sWzAsMywiXFxpZCJdLFswLDIsIk1cXERlbHRhIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibW9ubyJ9LCJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XV0=
\[\begin{tikzcd}
    && Ms \\
    \\
    Ms && {M(s \times s)} && {Ms}
    \arrow["{\pi_{1}}", from=3-3, to=3-1]
    \arrow["{\pi_{2}}"', from=3-3, to=3-5]
    \arrow["\id"', from=1-3, to=3-1]
    \arrow["\id", from=1-3, to=3-5]
    \arrow["M\Delta"{description}, dashed, tail, from=1-3, to=3-3]
  \end{tikzcd}\]

Algebraic theories together with their models and homomorphisms between them assemble into a 2-category $\CAlg$.
For any (small) algebraic theory $\cT$, the hom-category $\CAlg(\cT,\CSet)$, i.e., the category of set-theoretic models, is equivalent to a cocomplete category with a strong generator comprised of perfectly presentable objects, i.e., a variety.
We can generalize this viewpoint: theories (of some kind) are categories with sufficient structures.
A model of a theory in another theory (of the same kind) is a functor preserving those structures.
The goal of this writeup is to develop this idea in more detail.

\section{Hyperdoctrine}
\label{sec:hyperdoctrine}

The internal logic of a Heyting (or Boolean) algebra is intuitionistic (or classical) propositional logic.
Each sort of a given theory is equipped with a poset of propositions, in which $\varphi \leq \psi$ means $\varphi$ entails $\psi$.
For simplicity, let us assume a single sorted theory with no function symbols.
Let us recall Tarski's definition:
\begin{enumerate}
\item The unique sort is a set $S$.
\item A proposition variable is a subset of $S$.
\item $\top$ is the entire set $S$.
\item $\bot$ is the empty set $\varnothing$.
\item $\varphi \wedge \psi$ is the intersection $\varphi \cap \psi$.
\item $\varphi \vee \psi$ is the union $\varphi \cup \psi$.
\item $\varphi \To \psi$ is the exponential $\psi^{\varphi}$, i.e., the largest element so that $\psi^{\varphi} \wedge \varphi \leq \psi$.
\end{enumerate}

Essentially, propositions live in a poset with sufficient structure: various logical connectives correspond to various universal constructions.
As a model of a theory $\cT$ in another theory $\cT'$ has to preserve entailment, we expect it to be a function $M : \cT \to \cT'$ preserving relevant structures.

Generalizing this to multisorted theories is straightforward.
Each sort of the theory has a poset of propositions.
In the presence of nontrivial terms, we need to specify how propositions in context interact with substitutions.
For example, given a proposition in the context $d$, i.e., $\vdash_{d} \varphi$, substitution by a term $f : c \to d$ ought to produce a proposition in the context $c$, i.e., $\vdash_{c} \varphi[f]$.
Of course, we expect substitution to satisfy $\varphi[f][g] = \varphi[g \circ f]$ and $\varphi[\id] = \varphi$.

\begin{defn}
  A \emph{doctrine} is a functor $\cC : \iC\op \to \CPos$, where $\CPos$ is some suitable category of posets.
\end{defn}

\begin{defn}\label{def:model-of-doctrine}
  A \emph{model} of a doctrine $\cC : \iC\op \to \CPos$ in another doctrine $\cD : \iD\op \to \CPos$ consists of
  \begin{itemize}
  \item A model $M : \iC \to \iD$.
  \item A natural transformation $\lambda : \cC \To \cD \circ M\op$.
  \end{itemize}
  % https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXGlDXFxvcCJdLFsyLDAsIlxcaURcXG9wIl0sWzEsMSwiXFxDUG9zIl0sWzAsMSwiTVxcb3AiXSxbMCwyLCJcXGNDIiwyXSxbMSwyLCJcXGNEIl0sWzQsMSwiXFxsYW1iZGEiLDEseyJzaG9ydGVuIjp7InNvdXJjZSI6MTAsInRhcmdldCI6MTB9fV1d
  \[\begin{tikzcd}
      \iC\op && \iD\op \\
      & \CPos
      \arrow["M\op", from=1-1, to=1-3]
      \arrow[""{name=0, anchor=center, inner sep=0}, "\cC"', from=1-1, to=2-2]
      \arrow["\cD", from=1-3, to=2-2]
      \arrow["\lambda"{description}, shorten <=4pt, shorten >=4pt, Rightarrow, from=0, to=1-3]
    \end{tikzcd}\]
\end{defn}

Let us unpack \cref{def:model-of-doctrine}.
The model $M : \iC \to \iD$ is unsurprising: we need to express $\iC$ in terms of $\iD$.
Each component $\lambda_{c}$ is a model of propositions $\cC(c)$ in $\cD M\op(c)$.
Naturality expresses that these models are compatible with substitutions. 
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGNDKGMpIl0sWzIsMCwiXFxjRCBNXFxvcChjKSJdLFswLDIsIlxcY0MoYycpIl0sWzIsMiwiXFxjRCBNXFxvcChjJykiXSxbMCwxLCJcXGxhbWJkYV97Y30iXSxbMiwwLCJcXGJsYW5rW2ZdIl0sWzMsMSwiXFxibGFua1tNXFxvcChmKV0iLDJdLFsyLDMsIlxcbGFtYmRhX3tjJ30iLDJdXQ==
\[\begin{tikzcd}
    {\cC(c)} && {\cD M\op(c)} \\
    \\
    {\cC(c')} && {\cD M\op(c')}
    \arrow["{\lambda_{c}}", from=1-1, to=1-3]
    \arrow["{\blank[f]}", from=3-1, to=1-1]
    \arrow["{\blank[M\op(f)]}"', from=3-3, to=1-3]
    \arrow["{\lambda_{c'}}"', from=3-1, to=3-3]
  \end{tikzcd}\]

Weighted quantifiers can be characterized as adjoints, too.
Given a term $f : c \to d$, the formula $\exists_{f}\varphi$ ought to be the smallest formula so that $\varphi \leq (\exists_{f}\varphi)[f]$.
Similarly, the formula $\forall_{f}\varphi$ ought to be the largest formula so that $(\forall_{f}\varphi)[f] \leq \varphi$.
That is, we need the following adjoints:
% https://q.uiver.app/#q=WzAsMixbMCwwLCJcXGNDKGMpIl0sWzAsMiwiXFxjQyhkKSJdLFsxLDAsIlxcYmxhbmtbZl0iLDFdLFswLDEsIlxcZXhpc3RzX3tmfSIsMix7ImN1cnZlIjo0fV0sWzAsMSwiXFxmb3JhbGxfe2Z9IiwwLHsiY3VydmUiOi00fV0sWzMsMiwiIiwxLHsibGV2ZWwiOjEsInN0eWxlIjp7Im5hbWUiOiJhZGp1bmN0aW9uIn19XSxbMiw0LCIiLDEseyJsZXZlbCI6MSwic3R5bGUiOnsibmFtZSI6ImFkanVuY3Rpb24ifX1dXQ==
\[\begin{tikzcd}
    {\cC(c)} \\
    \\
    {\cC(d)}
    \arrow[""{name=0, anchor=center, inner sep=0}, "{f^{*}}"{description}, from=3-1, to=1-1]
    \arrow[""{name=1, anchor=center, inner sep=0}, "{\exists_{f}}"', curve={height=24pt}, from=1-1, to=3-1]
    \arrow[""{name=2, anchor=center, inner sep=0}, "{\forall_{f}}", curve={height=-24pt}, from=1-1, to=3-1]
    \arrow["\dashv"{anchor=center}, draw=none, from=1, to=0]
    \arrow["\dashv"{anchor=center}, draw=none, from=0, to=2]
  \end{tikzcd}\]
Indeed, in the powerset doctrine $\cP : \CSet\op \to \CPos$, the existential quantifier and the universal quantifier are given by the direct image $f_{*}$ and the fiber image $f_{!}$, respectively.

The powerset doctrine factors through the contravariant powerset functor in a canonical way because every powerset has a canonical poset structure given by the inclusion relation.
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGlEIl0sWzIsMCwiXFxDU2V0XFxvcCJdLFsxLDIsIlxcQ1BvcyJdLFszLDIsIlxcQ1NldCJdLFswLDIsIlxcY0QiLDJdLFswLDEsIk0iXSxbMSwzLCJcXGNQIl0sWzIsM10sWzEsMiwiIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV0sWzQsMSwiXFxsYW1iZGEiLDAseyJzaG9ydGVuIjp7InNvdXJjZSI6MTAsInRhcmdldCI6MTB9fV1d
\[\begin{tikzcd}
    \iU\op && \CSet\op \\
    \\
    & \CPos && \CSet
    \arrow[""{name=0, anchor=center, inner sep=0}, "\cU"', from=1-1, to=3-2]
    \arrow["M", from=1-1, to=1-3]
    \arrow["\cP", from=1-3, to=3-4]
    \arrow[from=3-2, to=3-4]
    \arrow[dashed, from=1-3, to=3-2]
    \arrow["\lambda", shorten <=5pt, shorten >=5pt, Rightarrow, from=0, to=1-3]
  \end{tikzcd}\]
Thus, we may identify a model of a doctrine as a natural transformation (of some kind) between presheaves.
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXGlEXFxvcCJdLFsyLDAsIlxcQ1NldFxcb3AiXSxbMiwyLCJcXENTZXQiXSxbMCwxXSxbMSwyXSxbMCwyLCJcXGNEIiwyXSxbNSwxLCJcXGxhbWJkYSIsMix7InNob3J0ZW4iOnsic291cmNlIjoxMCwidGFyZ2V0IjoxMH19XV0=
\[\begin{tikzcd}
    \iU\op && \CSet\op \\
    \\
    && \CSet
    \arrow[from=1-1, to=1-3]
    \arrow[from=1-3, to=3-3]
    \arrow[""{name=0, anchor=center, inner sep=0}, "\cU"', from=1-1, to=3-3]
    \arrow["\lambda"', shorten <=3pt, shorten >=3pt, Rightarrow, from=0, to=1-3]
  \end{tikzcd}\]
Given a natural transformation $\lambda : \cU \To \tilde{\cU}$ between presheaves, we may think of $\cU$ as a presheaf of ``witnesses'' and $\tilde{\cU}$ as a presheaf of ``types.''
By the Yoneda lemma, each type $A \in \tilde{\cU}(\Gamma)$ can be identified with a natural transformation $A : \iU(\blank, \Gamma) \To \cU$.
If we additionally require that the pullback of $A$ along $\lambda$ is representable, then the two projections correspond to a term $\Gamma.A \to \Gamma$ in the theory $\iU$ and a witness $t \in \cU(\Gamma.A)$, respectively.
% https://q.uiver.app/#q=WzAsNCxbMiwwLCJcXGNVIl0sWzIsMiwiXFx0aWxkZXtcXGNVfSJdLFswLDIsIlxceW9uXFxHYW1tYSJdLFswLDAsIlxceW9uXFxHYW1tYS5BIl0sWzAsMSwiXFxsYW1iZGEiXSxbMiwxLCJBIiwyXSxbMywyXSxbMywwLCJ0Il0sWzMsMSwiIiwxLHsic3R5bGUiOnsibmFtZSI6ImNvcm5lciJ9fV1d
\[\begin{tikzcd}
    {\yon\Gamma.A} && \cU \\
    \\
    \yon\Gamma && {\tilde{\cU}}
    \arrow["\lambda", from=1-3, to=3-3]
    \arrow["A"', from=3-1, to=3-3]
    \arrow[from=1-1, to=3-1]
    \arrow["t", from=1-1, to=1-3]
    \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=3-3]
  \end{tikzcd}\]

\section{Orthogonality}
\label{sec:orthogonality}

\begin{defn}
  An object $c$ is \emph{orthogonal} to a morphism $m : d \to d'$ if for each morphism $f : d \to c$, there is a unique morphism $f' : d' \to c$ so that the following diagram commutes.
  % https://q.uiver.app/#q=WzAsMyxbMCwwLCJkIl0sWzIsMCwiZCciXSxbMSwxLCJjIl0sWzAsMSwibSJdLFswLDIsImYiLDJdLFsxLDIsImYnIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV1d
  \[\begin{tikzcd}
      d && {d'} \\
      & c
      \arrow["m", from=1-1, to=1-3]
      \arrow["f"', from=1-1, to=2-2]
      \arrow["{f'}", dashed, from=1-3, to=2-2]
    \end{tikzcd}\]
  For a class $\cM$ of morphisms in a category $\iC$, we write $\cM^{\bot}$ for the full subcategory of $\iC$ spanned by objects orthogonal to each $m \in \cM$.
\end{defn}

The sketch condition can be transformed into an orthogonality problem.
Recall that a model of a given limit sketch $S = (\iC, L)$ is a functor $F : \iC \to \CSet$ preserving limits in $L$.
Now, given a limit diagram $D : \iE \to \iC$ (equivalently, a colimit in $\iC\op$) in $L$, there is a canonical natural transformation $\delta_{D} : \colim\yon D \To \yon\colim D$.
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXGlFIl0sWzIsMCwiXFxpQ1xcb3AiXSxbNCwwLCJcXFBzaChcXGlDXFxvcCkiXSxbMCwxLCJEIl0sWzEsMiwiXFx5b24iXV0=
\[\begin{tikzcd}
    \iE && \iC\op && {\Psh(\iC\op)}
    \arrow["D", from=1-1, to=1-3]
    \arrow["\yon", from=1-3, to=1-5]
  \end{tikzcd}\]
A functor $F : \iC \to \CSet$ preserves the limit diagram $D$ if and only if it is orthogonal to $\delta_{D}$.
Thus, $\Mod(S)$ is the orthogonal class $\Set{\delta_{D} \mid D \in L}^{\bot}$.
In fact, this is a reflective subcategory.
As this orthogonal class admits a limit sketch, it is locally presentable.
Thus, the inclusion functor $\cM^{\bot} \into \Psh(\iC\op)$ is naturally isomorphic to the Kan extension of its restriction along $\iota$.
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXFByZXMoXFxjTV57XFxib3R9KSJdLFsyLDAsIlxcY01ee1xcYm90fSJdLFs0LDAsIlxcUHNoKFxcaUNcXG9wKSJdLFsyLDIsIlxcY01ee1xcYm90fSJdLFswLDMsIlxcaW90YSIsMl0sWzAsMSwiXFxpb3RhIl0sWzEsMiwiRiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzMsMiwiXFxsYW5fe1xcaW90YX1GXFxpb3RhIiwyXSxbMywxLCJcXGlzbyIsMyx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6Im5vbmUifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dXQ==
\[\begin{tikzcd}
    {\Pres(\cM^{\bot})} && {\cM^{\bot}} && {\Psh(\iC\op)} \\
    \\
    && {\cM^{\bot}}
    \arrow["\iota"', from=1-1, to=3-3]
    \arrow["\iota", from=1-1, to=1-3]
    \arrow[hook, from=1-3, to=1-5]
    \arrow["{\lan_{\iota}\iota}"', from=3-3, to=1-5]
    \arrow["\iso"{marking, allow upside down}, draw=none, from=3-3, to=1-3]
  \end{tikzcd}\]
This implies that the inclusion functor has small arity and therefore admits a left adjoint.

\begin{thm}
  If $\cM$ is a pullback stable class of morphisms in $\iC$, then $\cM^{\bot}$ is reflective and the reflector is lex.
\end{thm}
\begin{proof}
  \todo{}
\end{proof}

\section{Sheaves}
\label{sec:sheaves}

Recall that a topology is a set of open sets closed under arbitrary unions and finite intersections.
Thus, set inclusion gives a natural poset structure on a topology.

\begin{defn}
  A \emph{frame} is a poset equipped with
  \begin{itemize}
  \item Arbitrary joins ($\bigvee$)
  \item Finite meets ($\wedge$)
  \end{itemize}
  so that the infinitary distributive law is satisfied:
  \[
    a \wedge \left(\bigvee_{i \in I}b_{i}\right) = \bigvee_{i \in I}a \wedge b_{i}
  \]
  A \emph{frame homomorphism} is an order-preserving function that also preserves all arbitrary joins and finite meets.
\end{defn}

Now, recall that a function $f : X \to Y$ is continuous if its inverse image restricts to a function $f^{*} : \cO(Y) \to \cO(X)$.
That is, if $y \subseteq Y$ is open, then $f\inv(y)$ is open in $X$.
Observe that $f^{*}$ is a frame homomorphism.
It appears that a frame contains sufficient structure to recover some topological information.

\begin{defn}
  A \emph{locale} is a frame.
  A \emph{continuous function} $f : X \to Y$ between locales is a frame homomorphism $f^{*} : \cO(Y) \to \cO(X)$.
  That is, the category of locales is the dual of that of frames.
\end{defn}

Given a topological space (or locale) $X$, we wish to construct geometric objects based on the open sets so that they respect the inclusion relation.
This construction can be encoded as a functor $F : \cO(X)\op \to \CSet$.
Additionally, we want objects to be uniquely determined by its constituents.
Thus, we impose the following conditions.
\begin{itemize}
\item Locality: For any two sections $s, t \in F(\cU_{1} \cup \cU_{2})$, if $s|_{\cU_{i}} = t|_{\cU_{i}}$ for $i = 1, 2$, then $s = t$.
\item Gluing: Given $s_{1} \in F(\cU_{1})$ and $s_{2} \in F(\cU_{2})$.
  If $s_{1}|_{\cU_{1} \cap \cU_{2}} = s_{2}|_{\cU_{1} \cap \cU_{2}}$, then there is $s \in F(\cU_{1} \cup \cU_{2})$ so that $s|_{\cU_{1}} = s_{1}$ and $s|_{\cU_{2}} = s_{2}$.
\end{itemize}
These two conditions can be expressed in a pullback diagram.
% https://q.uiver.app/#q=WzAsNSxbMSwxLCJGKFxcY1VfezF9IFxcY3VwIFxcY1VfezJ9KSJdLFsxLDMsIkYoXFxjVV97MX0pIl0sWzMsMSwiRihcXGNVX3syfSkiXSxbMywzLCJGKFxcY1VfezF9IFxcY2FwIFxcY1VfezJ9KSJdLFswLDAsIlxcYnVsbGV0Il0sWzAsMV0sWzEsM10sWzIsM10sWzAsMl0sWzQsMSwiIiwwLHsiY3VydmUiOjJ9XSxbNCwyLCIiLDAseyJjdXJ2ZSI6LTJ9XSxbNCwwLCIiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XSxbMCwzLCIiLDAseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XV0=
\[\begin{tikzcd}
    \bullet \\
    & {F(\cU_{1} \cup \cU_{2})} && {F(\cU_{2})} \\
    \\
    & {F(\cU_{1})} && {F(\cU_{1} \cap \cU_{2})}
    \arrow[from=2-2, to=4-2]
    \arrow[from=4-2, to=4-4]
    \arrow[from=2-4, to=4-4]
    \arrow[from=2-2, to=2-4]
    \arrow[curve={height=12pt}, from=1-1, to=4-2]
    \arrow[curve={height=-12pt}, from=1-1, to=2-4]
    \arrow[dashed, from=1-1, to=2-2]
    \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=2-2, to=4-4]
  \end{tikzcd}\]

\begin{defn}\label{def:sheaf}
  A \emph{sheaf} (of sets) over a topological space (or locale) $X$ is a functor
  \[
    F : \cO(X)\op \to \CSet
  \]
  preserving the pushouts of opens.
  % https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGNVX3sxfSBcXGNhcCBcXGNVX3syfSJdLFswLDIsIlxcY1VfezF9Il0sWzIsMCwiXFxjVV97Mn0iXSxbMiwyLCJcXGNVX3sxfSBcXGN1cCBcXGNVX3syfSJdLFswLDFdLFswLDJdLFsyLDNdLFsxLDNdLFszLDAsIiIsMSx7InN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dXQ==
  \[\begin{tikzcd}
      {\cU_{1} \cap \cU_{2}} && {\cU_{2}} \\
      \\
      {\cU_{1}} && {\cU_{1} \cup \cU_{2}}
      \arrow[from=1-1, to=3-1]
      \arrow[from=1-1, to=1-3]
      \arrow[from=1-3, to=3-3]
      \arrow[from=3-1, to=3-3]
      \arrow["\lrcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=3-3, to=1-1]
    \end{tikzcd}\]
\end{defn}

An immediate consequence of \cref{def:sheaf} is that the category of sheaves $\Sh(X)$ is sketchable by a limit sketch.
Thus, the inclusion functor $\Sh(X) \into \Psh(\cO(X))$ admits a left adjoint.
% https://q.uiver.app/#q=WzAsMixbMiwwLCJcXFBzaChcXGNPKFgpKSJdLFswLDAsIlxcU2goWCkiXSxbMSwwLCIiLDEseyJvZmZzZXQiOjIsInN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzAsMSwiXFx0ZXh0e3NoZWFmaWZ5fSIsMix7Im9mZnNldCI6Mn1dLFszLDIsIiIsMSx7ImxldmVsIjoxLCJzdHlsZSI6eyJuYW1lIjoiYWRqdW5jdGlvbiJ9fV1d
\[\begin{tikzcd}
    {\Sh(X)} && {\Psh(\cO(X))}
    \arrow[""{name=0, anchor=center, inner sep=0}, shift right=2, hook, from=1-1, to=1-3]
    \arrow[""{name=1, anchor=center, inner sep=0}, "{\text{sheafify}}"', shift right=2, from=1-3, to=1-1]
    \arrow["\dashv"{anchor=center, rotate=-90}, draw=none, from=1, to=0]
  \end{tikzcd}\]
The infinitary distributive law implies that the reflector is lex.

\section{Elementary topoi}
\label{sec:elementary-topoi}

\begin{defn}
  An (elementary) \emph{topos} is a cartesian closed category with finite limits and a subobject classifier.
\end{defn}

Let $\cE$ be a topos.
We write $PA$ for the exponential $\Omega^{A}$.
Let $\in_{A}$ be the subobject classified by the evaluation map $\ev_{A}$.
If $\cE = \CSet$, this is just the membership relation.
% https://q.uiver.app/#q=WzAsNCxbMCwyLCJQQSBcXHRpbWUgQSJdLFsyLDIsIlxcT21lZ2EiXSxbMiwwLCIxIl0sWzAsMCwiXFxpbl97QX0iXSxbMiwxLCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtb25vIn19fV0sWzAsMSwiXFxldl97QX0iLDJdLFszLDAsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1vbm8ifX19XSxbMywyXV0=
\[\begin{tikzcd}
    {\in_{A}} && 1 \\
    \\
    {PA \times A} && \Omega
    \arrow[tail, from=1-3, to=3-3]
    \arrow["{\ev_{A}}"', from=3-1, to=3-3]
    \arrow[tail, from=1-1, to=3-1]
    \arrow[from=1-1, to=1-3]
  \end{tikzcd}\]
Now, any subobject $R \mono B \times A$, which we think of as a relation from $B$ to $A$, is classified by a unique morphism $r'$.
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJSIl0sWzAsMiwiQiBcXHRpbWVzIEEiXSxbMiwyLCJcXE9tZWdhIl0sWzIsMCwiMSJdLFszLDIsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1vbm8ifX19XSxbMSwyLCJyJyIsMl0sWzAsMSwiIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibW9ubyJ9fX1dLFswLDNdXQ==
\[\begin{tikzcd}
    R && 1 \\
    \\
    {B \times A} && \Omega
    \arrow[tail, from=1-3, to=3-3]
    \arrow["{r'}"', from=3-1, to=3-3]
    \arrow[tail, from=1-1, to=3-1]
    \arrow[from=1-1, to=1-3]
  \end{tikzcd}\]
Since $\cE(B \times A, \Omega) \iso \cE(B, PA)$, $r$ corresponds to a (unique) morphism $r : B \to PA$ so that $\ev_{A} \circ (r \times \id) = r'$.
By the pasting lemma, the left square of the following diagram is a pullback.
% https://q.uiver.app/#q=WzAsNixbMiwwLCJcXGluX3tBfSJdLFsyLDIsIlBBIFxcdGltZXMgQSJdLFs0LDIsIlxcT21lZ2EiXSxbNCwwLCIxIl0sWzAsMiwiQiBcXHRpbWVzIEEiXSxbMCwwLCJSIl0sWzMsMiwiIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibW9ubyJ9fX1dLFsxLDIsIlxcZXZfe0F9IiwyXSxbMCwxLCIiLDEseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtb25vIn19fV0sWzAsM10sWzQsMSwiciBcXHRpbWVzIFxcaWQiLDJdLFs1LDQsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1vbm8ifX19XSxbNSwwXV0=
\[\begin{tikzcd}
    R && {\in_{A}} && 1 \\
    \\
    {B \times A} && {PA \times A} && \Omega
    \arrow[tail, from=1-5, to=3-5]
    \arrow["{\ev_{A}}"', from=3-3, to=3-5]
    \arrow[tail, from=1-3, to=3-3]
    \arrow[from=1-3, to=1-5]
    \arrow["{r \times \id}"', from=3-1, to=3-3]
    \arrow[tail, from=1-1, to=3-1]
    \arrow[from=1-1, to=1-3]
  \end{tikzcd}\]

\begin{defn}
  Let $\cE$ be a cartesian category.
  A \emph{power object} of an object $A$ is an object $PA$ equipped with a subobject $\in_{A} \mono PA \times A$ so that for any subobject $R \mono B \times A$, there is a unique morphism $r : B \to PA$ so that the following square is a pullback.
  % https://q.uiver.app/#q=WzAsNCxbMiwwLCJcXGluX3tBfSJdLFsyLDIsIlBBIFxcdGltZXMgQSJdLFswLDIsIkIgXFx0aW1lcyBBIl0sWzAsMCwiUiJdLFswLDEsIiIsMSx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Im1vbm8ifX19XSxbMiwxLCJyIFxcdGltZXMgXFxpZCIsMl0sWzMsMiwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibW9ubyJ9fX1dLFszLDBdXQ==
  \[\begin{tikzcd}
      R && {\in_{A}} \\
      \\
      {B \times A} && {PA \times A}
      \arrow[tail, from=1-3, to=3-3]
      \arrow["{r \times \id}"', from=3-1, to=3-3]
      \arrow[tail, from=1-1, to=3-1]
      \arrow[from=1-1, to=1-3]
    \end{tikzcd}\]
  The morphism $r : B \to PA$ is called the \emph{name} of the relation $R$.
\end{defn}
In fact, every cartesian category equipped with power objects is a topos.

\begin{defn}
  Let $\cE$ and $\cF$ be topoi.
  A functor $F : \cE \to \cF$ is said to be \emph{logical} if it preserves exponentials and subobject classifier.
  Equivalently, $F$ is logical if it preserves finite limits and power objects.
  That is, the name $\phi_{A} : FPA \to PFA$ of the relation $F(\in_{A})$ is an isomorphism for all $A \in \cE$.
\end{defn}

\bibliographystyle{alpha}
\bibliography{all}

\end{document}
