\documentclass[article,10pt,oneside]{memoir}
\input{preambles}
\title{categorical logic}
\author{Frank Tsai}
\date{\today}
%\thanks{}
\begin{document}
\maketitle
\tableofcontents

\section{Introduction}
\label{sec:introduction}

The categorification of algebraic theories enabled us to investigate these theories in a presentation-invariant way.
Algebraic theories are precisely categories with finite products.
We think of the objects of such a category as sorts and morphisms as terms.
Equations are internalized as the diagonal subobjects.
Given two algebraic theories $\cT$ and $\cT'$, a model of $\cT$ in $\cT'$ is a finite-product preserving functor $M : \cT \to \cT'$, ensuring that products of sorts in $\cT$ are interpreted (sensibly) as products of sorts in $\cT'$.
Additionally, this also ensures that equations are preserved.
Unsurprisingly, a homomorphism from $M$ to $M'$ is precisely a natural transformation $\alpha : M \To M'$.
% https://q.uiver.app/#q=WzAsNCxbMiwwLCJNcyJdLFswLDIsIk1zIl0sWzIsMiwiTShzIFxcdGltZXMgcykiXSxbNCwyLCJNKHMpIl0sWzIsMSwiXFxwaV97MX0iXSxbMiwzLCJcXHBpX3syfSIsMl0sWzAsMSwiXFxpZCIsMl0sWzAsMywiXFxpZCJdLFswLDIsIk1cXERlbHRhIiwxLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibW9ubyJ9LCJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XV0=
\[\begin{tikzcd}
    && Ms \\
    \\
    Ms && {M(s \times s)} && {Ms}
    \arrow["{\pi_{1}}", from=3-3, to=3-1]
    \arrow["{\pi_{2}}"', from=3-3, to=3-5]
    \arrow["\id"', from=1-3, to=3-1]
    \arrow["\id", from=1-3, to=3-5]
    \arrow["M\Delta"{description}, dashed, tail, from=1-3, to=3-3]
  \end{tikzcd}\]

Algebraic theories together with their models and homomorphisms between them assemble into a 2-category $\CAlg$.
For any (small) algebraic theory $\cT$, the hom-category $\CAlg(\cT,\CSet)$, i.e., the category of set-theoretic models, is equivalent to a cocomplete category with a strong generator comprised of perfectly presentable objects, i.e., a variety.
We can generalize this viewpoint: theories (of some kind) are categories with sufficient structures.
A model of a theory in another theory (of the same kind) is a functor preserving those structures.
The goal of this writeup is to develop this idea in more detail.

\section{Hyperdoctrine}
\label{sec:hyperdoctrine}

A theory in propositional logic is a Heyting (or Boolean) algebra.
Each sort of the theory is equipped with a poset of propositions, in which $\varphi \leq \psi$ means $\varphi$ entails $\psi$.
For simplicity, let us assume a single sorted theory with no function symbols.
Let us recall Tarski's definition:
\begin{enumerate}
\item The unique sort is a set $S$.
\item A proposition variable is a subset of $S$.
\item $\top$ is the entire set $S$.
\item $\bot$ is the empty set $\varnothing$.
\item $\varphi \wedge \psi$ is the intersection $\varphi \cap \psi$.
\item $\varphi \vee \psi$ is the union $\varphi \cup \psi$.
\item $\varphi \To \psi$ is the exponential $\psi^{\varphi}$, i.e., the largest element so that $\psi^{\varphi} \wedge \varphi \leq \psi$.
\end{enumerate}

Essentially, propositions live in a poset with sufficient structure: various logical connectives correspond to various universal constructions.
As a model of a theory $\cT$ in another theory $\cT'$ has to preserve entailment, we expect it to be a function $M : \cT \to \cT'$ preserving relevant structures.

Generalizing this to multisorted theories is straightforward.
Each sort of the theory has a poset of propositions.
In the presence of nontrivial terms, we need to specify how propositions in context interact with substitutions.
For example, given a proposition in the context $d$, i.e., $\vdash_{d} \varphi$, substitution by a term $f : c \to d$ ought to produce a proposition in the context $c$, i.e., $\vdash_{c} \varphi[f]$.
Of course, we expect substitution to satisfy $\varphi[f][g] = \varphi[g \circ f]$ and $\varphi[\id] = \varphi$.

\begin{defn}
  A \emph{doctrine} is a functor $\cC : \iC\op \to \CPos$, where $\CPos$ is some suitable category of posets.
\end{defn}

\begin{defn}\label{def:model-of-doctrine}
  A \emph{model} of a doctrine $\cC : \iC\op \to \CPos$ in another doctrine $\cD : \iD\op \to \CPos$ consists of
  \begin{itemize}
  \item A model $M : \iC \to \iD$.
  \item A natural transformation $\lambda : \cC \To \cD \circ M\op$.
  \end{itemize}
  % https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXGlDXFxvcCJdLFsyLDAsIlxcaURcXG9wIl0sWzEsMSwiXFxDUG9zIl0sWzAsMSwiTVxcb3AiXSxbMCwyLCJcXGNDIiwyXSxbMSwyLCJcXGNEIl0sWzQsMSwiXFxsYW1iZGEiLDEseyJzaG9ydGVuIjp7InNvdXJjZSI6MTAsInRhcmdldCI6MTB9fV1d
  \[\begin{tikzcd}
      \iC\op && \iD\op \\
      & \CPos
      \arrow["M\op", from=1-1, to=1-3]
      \arrow[""{name=0, anchor=center, inner sep=0}, "\cC"', from=1-1, to=2-2]
      \arrow["\cD", from=1-3, to=2-2]
      \arrow["\lambda"{description}, shorten <=4pt, shorten >=4pt, Rightarrow, from=0, to=1-3]
    \end{tikzcd}\]
\end{defn}

Let us unpack \cref{def:model-of-doctrine}.
The model $M : \iC \to \iD$ is unsurprising: we need to express $\iC$ in terms of $\iD$.
Each component $\lambda_{c}$ is a model of propositions $\cC(c)$ in $\cD M\op(c)$.
Naturality expresses that these models are compatible with substitutions. 
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGNDKGMpIl0sWzIsMCwiXFxjRCBNXFxvcChjKSJdLFswLDIsIlxcY0MoYycpIl0sWzIsMiwiXFxjRCBNXFxvcChjJykiXSxbMCwxLCJcXGxhbWJkYV97Y30iXSxbMiwwLCJcXGJsYW5rW2ZdIl0sWzMsMSwiXFxibGFua1tNXFxvcChmKV0iLDJdLFsyLDMsIlxcbGFtYmRhX3tjJ30iLDJdXQ==
\[\begin{tikzcd}
    {\cC(c)} && {\cD M\op(c)} \\
    \\
    {\cC(c')} && {\cD M\op(c')}
    \arrow["{\lambda_{c}}", from=1-1, to=1-3]
    \arrow["{\blank[f]}", from=3-1, to=1-1]
    \arrow["{\blank[M\op(f)]}"', from=3-3, to=1-3]
    \arrow["{\lambda_{c'}}"', from=3-1, to=3-3]
  \end{tikzcd}\]

Weighted quantifiers can be characterized as adjoints, too.
Given a term $f : c \to d$, the formula $\exists_{f}\varphi$ ought to be the smallest formula so that $\varphi \leq (\exists_{f}\varphi)[f]$.
Similarly, the formula $\forall_{f}\varphi$ ought to be the largest formula so that $(\forall_{f}\varphi)[f] \leq \varphi$.
That is, we need the following adjoints:
% https://q.uiver.app/#q=WzAsMixbMCwwLCJcXGNDKGMpIl0sWzAsMiwiXFxjQyhkKSJdLFsxLDAsIlxcYmxhbmtbZl0iLDFdLFswLDEsIlxcZXhpc3RzX3tmfSIsMix7ImN1cnZlIjo0fV0sWzAsMSwiXFxmb3JhbGxfe2Z9IiwwLHsiY3VydmUiOi00fV0sWzMsMiwiIiwxLHsibGV2ZWwiOjEsInN0eWxlIjp7Im5hbWUiOiJhZGp1bmN0aW9uIn19XSxbMiw0LCIiLDEseyJsZXZlbCI6MSwic3R5bGUiOnsibmFtZSI6ImFkanVuY3Rpb24ifX1dXQ==
\[\begin{tikzcd}
    {\cC(c)} \\
    \\
    {\cC(d)}
    \arrow[""{name=0, anchor=center, inner sep=0}, "{f^{*}}"{description}, from=3-1, to=1-1]
    \arrow[""{name=1, anchor=center, inner sep=0}, "{\exists_{f}}"', curve={height=24pt}, from=1-1, to=3-1]
    \arrow[""{name=2, anchor=center, inner sep=0}, "{\forall_{f}}", curve={height=-24pt}, from=1-1, to=3-1]
    \arrow["\dashv"{anchor=center}, draw=none, from=1, to=0]
    \arrow["\dashv"{anchor=center}, draw=none, from=0, to=2]
  \end{tikzcd}\]
Indeed, in the powerset doctrine $\cP : \CSet\op \to \CPos$, the existential quantifier and the universal quantifier are given by the direct image $f_{*}$ and the fiber image $f_{!}$, respectively.

The powerset doctrine factors through the contravariant powerset functor in a canonical way because every powerset has a canonical poset structure given by the inclusion relation.
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGlEIl0sWzIsMCwiXFxDU2V0XFxvcCJdLFsxLDIsIlxcQ1BvcyJdLFszLDIsIlxcQ1NldCJdLFswLDIsIlxcY0QiLDJdLFswLDEsIk0iXSxbMSwzLCJcXGNQIl0sWzIsM10sWzEsMiwiIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV0sWzQsMSwiXFxsYW1iZGEiLDAseyJzaG9ydGVuIjp7InNvdXJjZSI6MTAsInRhcmdldCI6MTB9fV1d
\[\begin{tikzcd}
    \iU\op && \CSet\op \\
    \\
    & \CPos && \CSet
    \arrow[""{name=0, anchor=center, inner sep=0}, "\cU"', from=1-1, to=3-2]
    \arrow["M", from=1-1, to=1-3]
    \arrow["\cP", from=1-3, to=3-4]
    \arrow[from=3-2, to=3-4]
    \arrow[dashed, from=1-3, to=3-2]
    \arrow["\lambda", shorten <=5pt, shorten >=5pt, Rightarrow, from=0, to=1-3]
  \end{tikzcd}\]
Thus, we may identify a model of a doctrine as a natural transformation (of some kind) between presheaves.
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXGlEXFxvcCJdLFsyLDAsIlxcQ1NldFxcb3AiXSxbMiwyLCJcXENTZXQiXSxbMCwxXSxbMSwyXSxbMCwyLCJcXGNEIiwyXSxbNSwxLCJcXGxhbWJkYSIsMix7InNob3J0ZW4iOnsic291cmNlIjoxMCwidGFyZ2V0IjoxMH19XV0=
\[\begin{tikzcd}
    \iU\op && \CSet\op \\
    \\
    && \CSet
    \arrow[from=1-1, to=1-3]
    \arrow[from=1-3, to=3-3]
    \arrow[""{name=0, anchor=center, inner sep=0}, "\cU"', from=1-1, to=3-3]
    \arrow["\lambda"', shorten <=3pt, shorten >=3pt, Rightarrow, from=0, to=1-3]
  \end{tikzcd}\]
Given a natural transformation $\lambda : \cU \To \tilde{\cU}$ between presheaves, we may think of $\cU$ as a presheaf of ``witnesses'' and $\tilde{\cU}$ as a presheaf of ``types.''
By the Yoneda lemma, each type $A \in \tilde{\cU}(\Gamma)$ can be identified with a natural transformation $A : \iU(\blank, \Gamma) \To \cU$.
If we additionally require that the pullback of $A$ along $\lambda$ is representable, then the two projections correspond to a term $\Gamma.A \to \Gamma$ in the theory $\iU$ and a witness $t \in \cU(\Gamma.A)$, respectively.
% https://q.uiver.app/#q=WzAsNCxbMiwwLCJcXGNVIl0sWzIsMiwiXFx0aWxkZXtcXGNVfSJdLFswLDIsIlxceW9uXFxHYW1tYSJdLFswLDAsIlxceW9uXFxHYW1tYS5BIl0sWzAsMSwiXFxsYW1iZGEiXSxbMiwxLCJBIiwyXSxbMywyXSxbMywwLCJ0Il0sWzMsMSwiIiwxLHsic3R5bGUiOnsibmFtZSI6ImNvcm5lciJ9fV1d
\[\begin{tikzcd}
    {\yon\Gamma.A} && \cU \\
    \\
    \yon\Gamma && {\tilde{\cU}}
    \arrow["\lambda", from=1-3, to=3-3]
    \arrow["A"', from=3-1, to=3-3]
    \arrow[from=1-1, to=3-1]
    \arrow["t", from=1-1, to=1-3]
    \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=3-3]
  \end{tikzcd}\]

\section{Sheaves}
\label{sec:sheaves}



\bibliographystyle{alpha}
\bibliography{all}

\end{document}
