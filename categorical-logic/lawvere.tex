\documentclass{zett}
\input{preambles}
\title{Lawvere theories}
\author{Frank Tsai}
\date{\today}
% \thanks{}
\begin{document}
\maketitle
\tableofcontents

\section{Sources}
\label{sec:sources}

\cite{borger91:generators}, \cite{lawvere63:functsem}, \cite{adamek10:algebraic}.

\section{Preliminaries}
\label{sec:preliminaries}

\begin{defn}
  Let $\iC$ be a small category and let $S : \iC \to \CSet$ be a functor that maps each object $c \in \iC$ to the singleton set and each morphism to the identity function.
  The \emph{connected component} of $\iC$ is $\colim S$.
\end{defn}

\begin{defn}
  A small category $\iC$ is said to be \emph{connected} if $\colim S$ is the singleton set.
\end{defn}

\begin{rmk}
  The empty category $\varnothing$ is not connected since the colimit of the empty diagram is the empty set.
\end{rmk}

\begin{defn}\label{defn:sifted-categories}
  A small category $\iC$ is \emph{sifted} if finite products in $\CSet$ commute with colimits over $\iC$.
  Concretely, a small category $\iC$ is sifted if, given a diagram $D : \iC \times \iJ \to \CSet$ where $\iJ$ is a finite set, the canonical morphism
  \[
    \delta : \colim_{\iC}\prod_{\iJ}D(c,j) \to \prod_{\iJ}\colim_{\iC}D(c,j)
  \]
  is an isomorphism.
  Colimits of diagrams over sifted categories are called \emph{sifted colimits}.
\end{defn}

\begin{defn}
  A small category $\iC$ is \emph{filtered} if every finite diagram $F : \iJ \to \iC$ admits a cocone.
  Colimits of diagrams over filtered categories are called \emph{filtered colimits}.
\end{defn}

\begin{rmk}
  It is well-known that filtered colimits commute with finite limits in $\CSet$.
\end{rmk}

\begin{lem}\label{lem:sifted-empty-binary}%
  A small category $\iC$ is sifted if and only if colimits under $\iC$ commute with the empty product and binary products.
\end{lem}
\begin{proof}
  The only if direction is trivial.
  Let $D : \iC \times \iJ \to \CSet$ be an arbitrary diagram.
  We proceed by induction on the size of $\iJ$.
  When $\iJ$ is the empty set, then $\Pi_{\iJ}\colim_{\iC}D(c,j)$ is the empty set, whereas $\Pi_{\iJ}D(c,j)$ is the initial object in $\CSet^{\iC}$ whose colimit is also the empty set.
  Thus, the canonical morphism $\delta$ must be an isomorphism.

  Now, consider the following colimit
  \[
    \colim_{\iD}\left(\prod_{i=1}^{n}D(d, j_{i}) \times D(d, j_{i+1})\right)
  \]
  This colimit commutes with binary products by the hypothesis.
  Thus,
  \[
    \colim_{\iD}\left(\prod_{i=1}^{n}D(d, j_{i}) \times D(d, j_{i+1})\right) \iso \colim_{\iD}\prod_{i=1}^{n}D(d, j_{i}) \times \colim_{\iD}D(d, j_{i+1})
  \]
  By the induction hypothesis, $\colim_{\iD}\prod_{i=1}^{n}D(d, j_{i}) \iso \prod_{i=1}^{n}\colim_{\iD}D(d, j_{i})$, so the statement follows.
\end{proof}

\begin{defn}
  A functor $F : \iC \to \iD$ is \emph{final} if, for any diagram $G : \iD \to \iE$ such that $\colim_{\iC}GF$ exists, then $\colim_{\iD}G$ exists and the canonical morphism $\colim_{\iC}GF \to \colim_{\iD}G$ is an isomorphism.
\end{defn}

\begin{lem}\label{lem:final-slice-connected}
  A functor $F : \iC \to \iD$ is final if and only if the slice category $d \dn F$ is connected for all $d \in \iD$.
\end{lem}
\begin{proof}
  Suppose that $F$ is final.
  Consider the diagram $\iD(d, F\blank) : \iC \to \CSet$.
  By hypothesis, $\colim_{\iC}\iD(d, F\blank) \iso \colim_{\iD}\iD(d, \blank)$.
  The colimit of the represented functor is the singleton set.
  Thus, $\colim_{\iC}\iD(d, F\blank)$ is also the singleton set, so $d \dn F$ is connected.

  Conversely, suppose that $d \dn F$ is connected for all $d \in \iD$.
  Let $G : \iD \to \iE$ be any diagram such that $\colim_{\iC}GF$ exists.
  We show that $\colim_{\iD}G$ is just $\colim_{\iC}GF$.
  Let $\lambda : GF \to e$ be the colimiting cocone.
  We construct a colimiting cocone $\lambda' : G \to e$ as follows.
  Choose an arbitrary object in $d \dn F$, i.e., an object $c \in \iC$ and a morphism $f : d \to Fc$.
  Then the component $\lambda'_{d}$ is the composite
  \[
    % https://q.uiver.app/#q=WzAsMyxbMCwyLCJHZCJdLFsyLDIsIkdGYyJdLFsyLDAsImUiXSxbMCwxLCJHZiIsMl0sWzEsMiwiXFxsYW1iZGFfe2N9IiwyXSxbMCwyLCJcXGxhbWJkYSdfe2R9Il1d
    \begin{tikzcd}
      && e \\
      \\
      Gd && GFc
      \arrow["Gf"', from=3-1, to=3-3]
      \arrow["{\lambda_{c}}"', from=3-3, to=1-3]
      \arrow["{\lambda'_{d}}", from=3-1, to=1-3]
    \end{tikzcd}
  \]
  Naturality of $\lambda'$ follows from the naturality of $\lambda$ and the fact that $d \dn F$ is connected for all $d \in \iD$.
  Connectedness means that there is a sequence of zig-zag morphisms so that every triangle in the square commutes.
  \[
    % https://q.uiver.app/#q=WzAsOCxbMCwwLCJHZCJdLFs0LDAsIkdGYyJdLFs0LDIsIkdGY197Mn0iXSxbNCwzLCJHRmNfezN9Il0sWzQsNCwiR0ZjJyJdLFswLDQsIkdkJyJdLFs0LDEsIkdGY197MX0iXSxbNiwyLCJlIl0sWzMsMl0sWzMsNF0sWzAsNSwiR2ciLDJdLFswLDEsIkdmIl0sWzUsNCwiR2YnIiwyXSxbMSw2XSxbMiw2XSxbMSw3LCJcXGxhbWJkYV97Y30iXSxbNCw3LCJcXGxhbWJkYV97Yyd9IiwyXSxbMCw2LCJHZl97MX0iLDFdLFs2LDcsIlxcbGFtYmRhX3tjX3sxfX0iLDFdLFszLDcsIlxcbGFtYmRhX3tjX3szfX0iLDFdLFswLDMsIkdmX3szfSIsMV0sWzAsNCwiRyhmJ2cpIiwyXV0=
    \begin{tikzcd}
      Gd &&&& GFc \\
      &&&& {GFc_{1}} \\
      &&&& {GFc_{2}} && e \\
      &&&& {GFc_{3}} \\
      {Gd'} &&&& {GFc'}
      \arrow[from=4-5, to=3-5]
      \arrow[from=4-5, to=5-5]
      \arrow["Gg"', from=1-1, to=5-1]
      \arrow["Gf", from=1-1, to=1-5]
      \arrow["{Gf'}"', from=5-1, to=5-5]
      \arrow[from=1-5, to=2-5]
      \arrow[from=3-5, to=2-5]
      \arrow["{\lambda_{c}}", from=1-5, to=3-7]
      \arrow["{\lambda_{c'}}"', from=5-5, to=3-7]
      \arrow["{Gf_{1}}"{description}, from=1-1, to=2-5]
      \arrow["{\lambda_{c_{1}}}"{description}, from=2-5, to=3-7]
      \arrow["{\lambda_{c_{3}}}"{description}, from=4-5, to=3-7]
      \arrow["{Gf_{3}}"{description}, from=1-1, to=4-5]
      \arrow["{G(f'g)}"', from=1-1, to=5-5]
    \end{tikzcd}
  \]
  It is easy to verify that this cocone is colimiting.
\end{proof}

\begin{thm}\label{thm:characterization-of-sifted}
  A small category $\iC$ is sifted if and only if it is connected and the diagonal functor $\Delta$ is final.
\end{thm}
\begin{proof}
  By \cref{lem:sifted-empty-binary}, the sifted condition is equivalent to that colimits under $\iC$ commute with the empty product and binary products.
  Let $D : \iC \to \CSet$ be an arbitrary diagram.
  Suppose that $\iC$ is sifted.
  Then,
  \[
    \colim_{\iC}\prod_{\varnothing}D \iso \prod_{\varnothing}\colim_{\iC}D \iso 1
  \]
  The empty product $\prod_{\varnothing}D$ is the terminal object $S$ in $\CSet^{\iC}$.
  Since $\colim_{\iC}S \iso 1$, $\iC$ is connected.
  Additionally, for any $c, c' \in \iC$
  \begin{align}
    \colim_{\iC}\iC \times \iC((c, c'), \Delta\blank) &= \colim_{\iC}(\iC(c, \blank) \times \iC(c', \blank))\\
                                            &\iso \colim_{\iC}\iC(c, \blank) \times \colim_{\iC}\iC(c', \blank)\\
                                            &\iso 1
  \end{align}
  Thus, the category of cospans $(c, c') \dn \Delta$ is connected.
  By \cref{lem:final-slice-connected}, $\Delta$ is final.
  
  Conversely, assume that $\Delta$ is final and that $\iC$ is connected.
  Then colimits commute with the empty product. 
  \[
    \colim_{\iC}\prod_{\varnothing}F(c,j) \iso \colim_{\iC}S \iso 1 \iso \prod_{\varnothing}\colim_{\iC}F(c,j)
  \]
  It remains to show that colimits commute with binary products.
  Let $G : \iC \times \iC \to \CSet$ be a functor defined by $(c, c') \mapsto F(c,j) \times F(c', j')$.
  Then,
  \begin{align}
    \colim_{\iC}F(c, j) \times F(c, j') &\iso \colim_{\iC}G\Delta\\
                                   &\iso \colim_{\iC \times \iC}G\\
                                   &\iso \colim_{c \in \iC}\colim_{c' \in \iC}F(c,j) \times F(c',j')\\
                                   &\iso \colim_{\iC}F(c, j) \times \colim_{\iC}F(c, j')
  \end{align}
  The last isomorphism follows from the fact that $\blank \times X$ is a left adjoint (colimit preserving) for any set $X$ and that $A \times B \iso B \times A$.
\end{proof}

\begin{cor}\label{cor:finite-coproducts-then-sifted}
  Every small category $\iC$ with finite coproducts is sifted.
\end{cor}
\begin{proof}
  By \cref{thm:characterization-of-sifted}, it suffices to show that $\iC$ is connected and that for all $c, c' \in \iC$, the category of cospans $(c, c') \dn \Delta$ is connected.
  $\iC$ has an initial object, so it is connected.
  $\iC$ has binary coproducts, so for any $c, c' \in \iC$, their coproduct in $\iC$ corresponds to the initial object in $(c, c') \dn \Delta$.
  Thus, the category of cospans is connected.
\end{proof}

\begin{lem}\label{lem:functor-category-sifted-colimits-commute-with-finite-products}
  For any small category $\iC$, sifted colimits in $\CSet^{\iC}$ commute with finite products.
\end{lem}
\begin{proof}
  Let $D : \iS \times \iJ \to \CSet^{\iC}$ be a diagram where $\iS$ is a sifted category and $\iJ$ is a finite set.
  The colimit $\colim_{\iS}\prod_{\iJ}D(s,j)$ is computed componentwise: $\colim_{\iS}\prod_{\iJ}D(s,j)(c)$ is the colimit $\colim_{\iS}\prod_{\iJ}\ev_{c}D(s,j)$.
  By definition, sifted colimits commute with finite products in $\CSet$, i.e.,
  \[
    \colim_{\iS}\prod_{\iJ}\ev_{c}D(s,j) \iso \prod_{\iJ}\colim_{\iS}\ev_{c}D(s,j)
  \]
  for all $c \in \iC$.
  These isomorphisms assemble into a natural isomorphism:
  \[
    \colim_{S}\prod_{J}D(s,j) \iso \prod_{J}\colim_{S}D(s,j)
  \]
\end{proof}

\begin{defn}
  Let $\iJ$ be the following category
  \[
    % https://q.uiver.app/#q=WzAsMixbMCwwLCJcXGJ1bGxldCJdLFsyLDAsIlxcYnVsbGV0Il0sWzAsMSwiZiIsMCx7Im9mZnNldCI6LTJ9XSxbMCwxLCJnIiwyLHsib2Zmc2V0IjoyfV0sWzEsMCwicyIsMV1d
    \begin{tikzcd}
      \bullet && \bullet
      \arrow[shift left=2, from=1-1, to=1-3]
      \arrow[shift right=2, from=1-1, to=1-3]
      \arrow[from=1-3, to=1-1]
    \end{tikzcd}
  \]
  Colimits of diagrams of shape $\iJ$ are called \emph{reflexive coequalizers}.
  These are equalizers of parallel pairs that admit a common section.
\end{defn}

\begin{rmk}
  Reflexive coequalizers are sifted colimits.
\end{rmk}

\begin{lem}\label{lem:retract-colimit-preserved}
  If $c' \in \iC$ is a retract of $c \in \iC$, then the functor $\iC(c', \blank)$ preserves any colimit preserved by $\iC(c, \blank)$.
\end{lem}
\begin{proof}
  Let $r : c \to c'$ be a retraction to the section $s : c' \to c$.
  Consider the following absolute coequalizer diagram:
  % https://q.uiver.app/#q=WzAsMyxbMiwwLCJcXGlDKGMsXFxibGFuaykiXSxbNCwwLCJcXGlDKGMnLFxcYmxhbmspIl0sWzAsMCwiXFxpQyhjLFxcYmxhbmspIl0sWzAsMSwiXFxpQyhzLFxcYmxhbmspIl0sWzEsMCwiXFxpQyhyLFxcYmxhbmspIiwwLHsiY3VydmUiOi0yfV0sWzIsMCwiXFxpQyhycyxcXGJsYW5rKSIsMCx7Im9mZnNldCI6LTF9XSxbMiwwLCJcXGlkIiwyLHsib2Zmc2V0IjoxfV0sWzAsMiwiXFxpZCIsMCx7ImN1cnZlIjotM31dXQ==
  \[\begin{tikzcd}
      {\iC(c,\blank)} && {\iC(c,\blank)} && {\iC(c',\blank)}
      \arrow["{\iC(s,\blank)}", from=1-3, to=1-5]
      \arrow["{\iC(r,\blank)}", curve={height=-12pt}, from=1-5, to=1-3]
      \arrow["{\iC(rs,\blank)}", shift left, from=1-1, to=1-3]
      \arrow["\id"', shift right, from=1-1, to=1-3]
      \arrow["\id", curve={height=-18pt}, from=1-3, to=1-1]
    \end{tikzcd}\]
  Since it is an absolute coequalizer, it is preserved by the evaluation functor $\ev_{\colim\iD} : \CSet^{\iC} \to \CSet$.
  % https://q.uiver.app/#q=WzAsMyxbMiwwLCJcXGlDKGMsXFxjb2xpbVxcaUQpIl0sWzQsMCwiXFxpQyhjJyxcXGNvbGltXFxpRCkiXSxbMCwwLCJcXGlDKGMsXFxjb2xpbVxcaUQpIl0sWzAsMSwiXFxpQyhzLFxcYmxhbmspX3tcXGNvbGltXFxpRH0iXSxbMSwwLCJcXGlDKHIsXFxibGFuaylfe1xcY29saW1cXGlEfSIsMCx7ImN1cnZlIjotMn1dLFsyLDAsIlxcaUMocnMsXFxibGFuaylfe1xcY29saW1cXGlEfSIsMCx7Im9mZnNldCI6LTF9XSxbMiwwLCJcXGlkIiwyLHsib2Zmc2V0IjoxfV0sWzAsMiwiXFxpZCIsMCx7ImN1cnZlIjotM31dXQ==
  \[\begin{tikzcd}
      {\iC(c,\colim\iD)} && {\iC(c,\colim\iD)} && {\iC(c',\colim\iD)}
      \arrow["{\iC(s,\blank)_{\colim\iD}}", from=1-3, to=1-5]
      \arrow["{\iC(r,\blank)_{\colim\iD}}", curve={height=-12pt}, from=1-5, to=1-3]
      \arrow["{\iC(rs,\blank)_{\colim\iD}}", shift left, from=1-1, to=1-3]
      \arrow["\id"', shift right, from=1-1, to=1-3]
      \arrow["\id", curve={height=-18pt}, from=1-3, to=1-1]
    \end{tikzcd}\]
  and similarly it is preserved by the functor $\colim(\blank \circ D) : \CSet^{\iC} \to \CSet$.
  % https://q.uiver.app/#q=WzAsMyxbMiwwLCJcXGNvbGltXFxpQyhjLERcXGJsYW5rKSJdLFs0LDAsIlxcY29saW1cXGlDKGMnLERcXGJsYW5rKSJdLFswLDAsIlxcY29saW1cXGlDKGMsRFxcYmxhbmspIl0sWzAsMSwiXFxjb2xpbVxcaUMocyxcXGJsYW5rKV97RFxcYmxhbmt9Il0sWzEsMCwiXFxjb2xpbVxcaUMocixcXGJsYW5rKV97RFxcYmxhbmt9IiwwLHsiY3VydmUiOi0yfV0sWzIsMCwiXFxjb2xpbVxcaUMocnMsXFxibGFuaylfe0RcXGJsYW5rfSIsMCx7Im9mZnNldCI6LTF9XSxbMiwwLCJcXGlkIiwyLHsib2Zmc2V0IjoxfV0sWzAsMiwiXFxpZCIsMCx7ImN1cnZlIjotM31dXQ==
  \[\begin{tikzcd}
      {\colim\iC(c,D\blank)} && {\colim\iC(c,D\blank)} && {\colim\iC(c',D\blank)}
      \arrow["{\colim\iC(s,\blank)_{D\blank}}", from=1-3, to=1-5]
      \arrow["{\colim\iC(r,\blank)_{D\blank}}", curve={height=-12pt}, from=1-5, to=1-3]
      \arrow["{\colim\iC(rs,\blank)_{D\blank}}", shift left, from=1-1, to=1-3]
      \arrow["\id"', shift right, from=1-1, to=1-3]
      \arrow["\id", curve={height=-18pt}, from=1-3, to=1-1]
    \end{tikzcd}\]
  If $\iC(c,\colim D) \iso \colim\iC(c,D\blank)$, then this isomorphism together with $\iC(s,\blank)_{\colim D}$ form a cocone over the pair $\colim\iC(rs,\blank)_{D\blank}$ and $\id$.
  Similarly, $\colim\iC(s,\blank)_{D\blank}$ with the isomorphism form a cocone over $\iC(rs,\blank)_{\colim D}$ and $\id$.
  Thus, $\iC(c',\colim D) \iso \colim\iC(c', D\blank)$.
\end{proof}

\begin{lem}\label{lem:pp-closed-under-coprod}
  In a category $\iC$,
  \begin{enumerate}
  \item Perfectly presentable objects are closed under finite coproducts if it exists.
  \item Finitely presentable objects are closed under finite colimits if it exists.
  \end{enumerate}
\end{lem}
\begin{proof}
  Given a finite set of perfectly presentable objects $(c_{j})_{j \in \iJ}$.
  Suppose that $\coprod_{\iJ}c_{j}$ exists, then for any sifted colimits $\colim D$, we have
  \[
    \iC(\coprod_{\iJ}c_{j},\colim D) \iso \prod_{\iJ\op}\iC(c_{j},\colim D) \iso \prod_{\iJ\op}\colim\iC(c_{j},D\blank)
  \]
  By definition, sifted colimits commute with finite products.
  Thus, we have
  \[
    \prod_{\iJ\op}\colim\iC(c_{j},D\blank) \iso \colim\prod_{\iJ\op}\iC(c_{j},D\blank) \iso \colim\iC(\coprod_{\iJ}c_{j},D\blank)
  \]
  The proof for statement 2 is completely analogous.
\end{proof}

\begin{defn}
  Let $\iC$ be a category.
  A \emph{generator} of $\iC$ consists of a set of objects $\iG$ so that for all $c \in \iC$, all morphisms from $\iG$ to $c$ are jointly epimorphic.
  If $\iC$ has coproducts, then this is equivalent to the condition that the canonical morphism
  \[
    e_{c} : \left(\coprod_{(G,g) \in \iG \dn c}G\right) \to c
  \]
  is epimorphic.
  A generator is \emph{strong} if the morphisms are jointly extremal.
\end{defn}

\begin{lem}\label{lem:colimits-strong-generators}
  Let $\iC$ be a small category with colimits.
  If $\iG$ is a dense set of $\iC$, i.e., the inclusion functor $\iota : \iG \to \iC$ is dense, then $\iG$ is a strong generator.
\end{lem}
\begin{proof}
  As $c$ is the colimit of $\iota$, $c$ is a regular quotient of $\coprod_{\iG \dn c}G$.
  That is,
  \[
    \left(\coprod_{(G,g) \in \iG \dn c}G\right) \xrightarrow{e_{c}} c
  \]
  is a regular epimorphism.
  Thus, it is also an extremal epimorphism.
\end{proof}

\begin{lem}\label{lem:srong-coprod-comp-strong}
  Let $\iC$ be a small category with colimits and $\iG$ be a (strong) generator of $\iC$.
  If $\iG'$ is a coproduct completion of $\iG$ in $\iC$, i.e., $\iG'$ is a superset of $\iG$ closed under coproducts of objects in $\iG$, then $\iG'$ is also a (strong) generator.
\end{lem}
\begin{proof}
  As $\iG'$ is a coproduct completion of $\iG$, $\coprod_{(G,g) \in \iG \dn c}G$ is an object in $\iG'$.
  For any object $c \in \iC$, the fact that morphisms from $\iG$ to $c$ are jointly (extremal) epimorphic implies that the canonical morphism $e_{c} : \left(\coprod_{(G,g) \in \iG \dn c}G\right) \to c$ is (extremal) epimorphic.
  Thus, morphisms from $\iG'$ (for which $e_{c}$ is one of them) to $c$ are (trivially) jointly (extremal) epimorphic.
\end{proof}

\begin{lem}\label{lem:sg-pp-dense}
  Let $\iC$ be a small category with colimits.
  If $\iG$ is a strong generator of $\iC$ consisting of perfectly presentable objects, then any coproduct completion of $\iG$ in $\iC$ is dense.
\end{lem}
\begin{proof}
  By \cref{lem:srong-coprod-comp-strong}, any coproduct completion of $\iG$ in $\iC$ is a strong generator.
  Thus, we may assume that $\iG$ is closed under coproducts without loss of generality.

  Let $c \in \iC$ be an object and $\alpha : \dom \to c'$ be a colimiting cocone of the domain functor.
  We need to show that $c \iso c'$.
  Let $\beta : \dom \to c$ be a cocone defined by $\beta_{(G,g)} := g$.
  This indeed defines a cocone because a morphism $m : (G,g) \to (G',g')$ consists of a morphism $m : G \to G'$ so that $mg = g'$.
  % https://q.uiver.app/#q=WzAsMyxbMiwwLCJjIl0sWzAsMiwiXFxkb20oRyxnKSJdLFs0LDIsIlxcZG9tKEcnLGcnKSJdLFsxLDIsIlxcZG9tKG0pIiwyXSxbMSwwLCJcXGJldGFfeyhHLGcpfSA9IGciXSxbMiwwLCJcXGJldGFfeyhHJyxnJyl9ID0gZyciLDJdXQ==
  \[\begin{tikzcd}
      && c \\
      \\
      {\dom(G,g)} &&&& {\dom(G',g')}
      \arrow["{\dom(m)}"', from=3-1, to=3-5]
      \arrow["{\beta_{(G,g)} = g}", from=3-1, to=1-3]
      \arrow["{\beta_{(G',g')} = g'}"', from=3-5, to=1-3]
    \end{tikzcd}\]
  Thus, there is a unique morphism $k : c' \to c$ so that $k \cdot \alpha = \beta$.

  We show that the morphism $k$ is monomorphic for objects in $\iG$.
  This can then be generalized to any object in $\iC$.
  Let $x \in \iG$.
  Since $\iG$ has coproducts, so does $\iG \dn c$.
  By \cref{cor:finite-coproducts-then-sifted}, $\iG \dn c$ is sifted.
  That is, $c'$ is a sifted colimit.
  As $x$ is perfectly presentable, we have
  \[
    \iC(x, c') = \iC(x, \colim_{\iG \dn c}\dom) \iso \colim_{\iG \dn c}\iC(x, \dom\blank)
  \]
  That is, $\iC(x, c')$ is the colimit of the diagram $\iC(x, \dom\blank)$.
  A colimiting cocone is obtained by applying $\iC(x,\blank)$ to each component of $\alpha$.
  % https://q.uiver.app/#q=WzAsMyxbMSwwLCJcXGlDKHgsYycpIl0sWzAsMSwiXFxpQyh4LFxcZG9tKEcsZykpIl0sWzIsMSwiXFxpQyh4LFxcZG9tKEcnLGcnKSkiXSxbMSwyXSxbMSwwLCJcXGFscGhhX3soRyxnKX1cXGNpcmMgXFxibGFuayJdLFsyLDAsIlxcYWxwaGFfeyhHJyxnJyl9XFxjaXJjIFxcYmxhbmsiLDJdXQ==
  \[\begin{tikzcd}
      & {\iC(x,c')} \\
      {\iC(x,\dom(G,g))} && {\iC(x,\dom(G',g'))}
      \arrow[from=2-1, to=2-3]
      \arrow["{\alpha_{(G,g)}\circ \blank}", from=2-1, to=1-2]
      \arrow["{\alpha_{(G',g')}\circ \blank}"', from=2-3, to=1-2]
    \end{tikzcd}\]
  Thus, for any $u \in \iC(x, c')$ there is some $(G,g) \in \iG \dn c$ and $\util \in \iC(x, \dom(G,g))$ so that $\alpha_{(G,g)} \circ \util = u$.
  % https://q.uiver.app/#q=WzAsNCxbMCwyLCJ4Il0sWzAsMCwiRyJdLFsyLDIsImMnIl0sWzQsMiwiYyJdLFswLDEsIlxcdXRpbCJdLFsxLDIsIlxcYWxwaGFfeyhHLGcpfSIsMV0sWzAsMiwidSIsMl0sWzIsMywiayIsMl0sWzEsMywiXFxiZXRhX3soRyxnKX0gPSBnIiwwLHsiY3VydmUiOi0xfV1d
  \[\begin{tikzcd}
      G \\
      \\
      x && {c'} && c
      \arrow["\util", from=3-1, to=1-1]
      \arrow["{\alpha_{(G,g)}}"{description}, from=1-1, to=3-3]
      \arrow["u"', from=3-1, to=3-3]
      \arrow["k"', from=3-3, to=3-5]
      \arrow["{\beta_{(G,g)} = g}", curve={height=-6pt}, from=1-1, to=3-5]
    \end{tikzcd}\]
  Naturality of $\alpha$ then demands that $\alpha_{(G,g)} \circ \util = \alpha_{(G,ku)}$.
  Let $u,v : x \toto c'$ be any pair of morphisms so that $ku = kv$.
  Then $\alpha_{(G,ku)} = \alpha_{(G,g)} \circ \util = u = \alpha_{(G,kv)} = \alpha_{(G',g')} \circ \vtil = v$.

  Now let $x \in \iC$ and $u, v : x \toto c'$ be any parallel pair so that $ku = kv$.
  Consider the following composites
  % https://q.uiver.app/#q=WzAsNCxbMSwwLCJ4Il0sWzIsMCwiYyciXSxbMCwwLCJcXGNvcHJvZF97KEcsZykgXFxpbiBcXGlHIFxcZG4geH1HIl0sWzMsMCwiYyJdLFsyLDAsImVfe3h9Il0sWzAsMSwidSIsMCx7Im9mZnNldCI6LTF9XSxbMCwxLCJ2IiwyLHsib2Zmc2V0IjoxfV0sWzEsMywiayJdXQ==
  \[\begin{tikzcd}
      {\coprod_{(G,g) \in \iG \dn x}G} & x & {c'} & c
      \arrow["{e_{x}}", from=1-1, to=1-2]
      \arrow["u", shift left, from=1-2, to=1-3]
      \arrow["v"', shift right, from=1-2, to=1-3]
      \arrow["k", from=1-3, to=1-4]
    \end{tikzcd}\]
  Since $\coprod_{(G,g) \in \iG \dn x}G \in \iG$, $k$ is monomorphic for objects in $\iG$ and $kue_{x} = kve_{x}$, we have $ue_{x} = ve_{x}$.
  As $e_{x}$ is epimorphic, $u = v$.

  To show that $k$ is an isomorphism, it suffices to show that $k$ is an extremal epimorphism.
  Consider the following commutative diagram
  % https://q.uiver.app/#q=WzAsMyxbMCwyLCJjJyJdLFsyLDIsImMiXSxbMSwwLCJcXGNvcHJvZF97KEcsZykgXFxpbiBcXGlHIFxcZG4gY31HIl0sWzAsMSwiayIsMl0sWzIsMCwiXFxhbHBoYV97KFxcY29wcm9kX3soRyxnKSBcXGluIFxcaUcgXFxkbiBjfUcsIGVfe2N9KX0iLDJdLFsyLDEsIlxcYmV0YV97KFxcY29wcm9kX3soRyxnKSBcXGluIFxcaUcgXFxkbiBjfUcsIGVfe2N9KX0gPSBlX3tjfSJdXQ==
  \[\begin{tikzcd}
      & {\coprod_{(G,g) \in \iG \dn c}G} \\
      \\
      {c'} && c
      \arrow["k"', from=3-1, to=3-3]
      \arrow["{\alpha_{(\coprod_{(G,g) \in \iG \dn c}G, e_{c})}}"', from=1-2, to=3-1]
      \arrow["{\beta_{(\coprod_{(G,g) \in \iG \dn c}G, e_{c})} = e_{c}}", from=1-2, to=3-3]
    \end{tikzcd}\]
  Since $e_{c}$ is an extremal epimorphism, it follows that $k$ is an extremal epimorphism.
\end{proof}

\begin{lem}\label{lem:realization}
  Let $\iC$ be a category with colimits.
  Let $\iG$ be a small category and $\iota : \iG \to \iC$ be a functor.
  The restricted Yoneda embedding $\yon_{\iG} : \iC \to \CSet^{\iG\op}$ admits a realization, i.e., a left adjoint.
  Additionally, if $\iota$ is dense, then $\iC$ is a reflective subcategory of $\CSet^{\iG\op}$.
\end{lem}
\begin{proof}
  As $\iC$ is cocomplete and $\iG$ is small, the colimit
  \[
    \colim\left((\yon \dn F) \xrightarrow{\Pi_{F}} \iG \xrightarrow{\iota} \iC\right)
  \]
  exists for all $F \in \CSet^{\iG\op}$.
  This is precisely the colimit formula defining a left Kan extension of $\iota$ along the Yoneda embedding.
  % https://q.uiver.app/#q=WzAsMyxbMiwyLCJcXENTZXRee1xcaUdcXG9wfSJdLFswLDAsIlxcaUciXSxbNCwwLCJcXGlDIl0sWzEsMCwiXFx5b24iLDJdLFsxLDIsIlxcaW90YSJdLFswLDIsIlxcaW90YV57Kn0iLDAseyJvZmZzZXQiOi0yfV0sWzIsMCwiXFx5b25fe1xcaUd9IiwwLHsib2Zmc2V0IjotMn1dLFs1LDYsIiIsMix7ImxldmVsIjoxLCJzdHlsZSI6eyJuYW1lIjoiYWRqdW5jdGlvbiJ9fV1d
  \[\begin{tikzcd}
      \iG &&&& \iC \\
      \\
      && {\CSet^{\iG\op}}
      \arrow["\yon"', from=1-1, to=3-3]
      \arrow["\iota", from=1-1, to=1-5]
      \arrow[""{name=0, anchor=center, inner sep=0}, "{\iota^{*}}", shift left=2, from=3-3, to=1-5]
      \arrow[""{name=1, anchor=center, inner sep=0}, "{\yon_{\iG}}", shift left=2, from=1-5, to=3-3]
      \arrow["\dashv"{anchor=center, rotate=-50}, draw=none, from=0, to=1]
    \end{tikzcd}\]
  Indeed, this extension admits $\yon_{\iG}$ as the right adjoint.
  The remaining detail can be found in \cite{riehl:category}.

  If $\iota$ is dense, then $\yon_{\iG}$ is fully faithful.
  Thus, $\iC$ is a reflective subcategory.
\end{proof}

\begin{cor}
  If $\iC$ is a cocomplete category with a dense set of objects $\iG$, then $\iC$ is complete.
\end{cor}
\begin{proof}
  By \cref{lem:realization}, $\iC$ is a reflective subcategory of $\CSet^{\iG\op}$.
  As $\CSet^{\iG\op}$ is complete, so is $\iC$.
\end{proof}

\section{Algebraic theories and algebraic categories}
\label{sec:algebraic-theories-and-algebraic-categories}

An algebraic theory can be presented as a set of terms satisfying some equations.
We can view these terms as morphisms in a category, and composition as substitution.
Familiar algebraic theories, such as the theory of groups, are single sorted, but there is no reason to restrict to single sorted theories.

\begin{defn}
  An \emph{algebraic theory} is a small category $\cT$ with finite products.
\end{defn}

\begin{defn}
  Let $\cT$ be an algebraic theory, we define the category of \emph{algebras} $\Alg(\cT)$ as the full subcategory $\CSet^{\cT}$ spanned by finite-product preserving functors.
  A \emph{homomorphism} between two algebras is a natural transformation.
\end{defn}

\begin{defn}
  A category is said to be \emph{algebraic} if it is equivalent to $\Alg(\cT)$ for some algebraic theory $\cT$.
\end{defn}

\begin{thm}
  Every algebraic category is complete.
\end{thm}
\begin{proof}
  It suffices to show that $\Alg(\cT)$ is complete for all Lawvere theory $\cT$.
  Let $D : \iJ \to \Alg(\cT)$ be any small diagram.
  Consider the diagram
  \[
    \iota D : \iJ \to \CSet^{\cT}
  \]
  where $\iota$ is the inclusion functor.
  Since $\iota$ is fully faithful, it reflects limits.
  The limit $\lim \iota D$ exists because $\CSet^{\cT}$ is complete.
  Now, it suffices to show that $\Alg(\cT)$ has enough limits so that $\iota$ creates limits.
  To this end, we show that $\lim \iota D$ is limit preserving (therefore, finite-product preserving).
  For an arbitrary diagram $G : \iC \to \cT$, we have
  \[
    \lim_{\iJ} \iota D(\lim_{\iC}G) \iso \lim_{\iJ}\lim_{\iC}\iota D \circ G \iso \lim_{\iC}\lim_{\iJ}\iota D \circ G
  \]
\end{proof}

\begin{lem}\label{lem:inclusion-creates-sifted-colimits}%
  Let $\cT$ be a Lawvere theory.
  The inclusion functor $\iota : \Alg(\cT) \to \CSet^{\cT}$ creates colimits of sifted diagrams.
\end{lem}
\begin{proof}
  Let $\iS$ be a sifted category and $D : \iS \to \Alg(\cT)$ be a diagram.
  Since $\CSet^{\cT}$ is cocomplete (therefore, it has all sifted colimits) and $\iota$ reflects all colimits, it suffices to show that $\colim_{\iS}\iota \circ D$ is a finite-product preserving functor, but this is immediate from \cref{lem:functor-category-sifted-colimits-commute-with-finite-products}.
\end{proof}

\begin{thm}\label{thm:algebraic-categories-has-sifted-colimits}
  Every algebraic category is closed under sifted colimits.
\end{thm}
\begin{proof}
  It suffices to show that $\Alg(\cT)$ is closed under sifted colimits for all Lawvere theory $\cT$.
  By \cref{lem:inclusion-creates-sifted-colimits}, $\iota$ creates sifted colimits.
  Since $\CSet^{\cT}$ is cocomplete, it follows that $\Alg(\cT)$ has sifted colimits.
\end{proof}

\begin{cor}
  Sifted colimits commute with finite products in algebraic categories.
\end{cor}
\begin{proof}
  It suffices to prove this statement for $\Alg(\cT)$, where $\cT$ is an arbitrary Lawvere theory.
  The inclusion functor $\iota$ reflects isomorphism because it is fully faithful.
  Thus, the isomorphism in \cref{lem:functor-category-sifted-colimits-commute-with-finite-products} is reflected to an isomorphism in $\Alg(\cT)$.
\end{proof}

\section{Algebraic categories as free cocompletions}
\label{sec:algebraic-categories-as-free-cocompletions}

For a small category $\iC$, every set valued functor $F : \iC \to \CSet$ is naturally isomorphic to $\colim \yon\Pi_{F}$, where $\Pi_{F} : (\yon \dn F)\op \to \iC\op$ is the projection functor out of the opposite of the category of elements of $F$.

Given a Lawvere theory $\cT$ and an object $t \in \cT$, the represented functor $\cT(t, \blank) : \cT \to \CSet$ is limit preserving, so $\cT(t, \blank)$ is an algebra.
We call these algebras \emph{represented algebras}.
Indeed, every algebra can be expressed as a colimit of represented algebras.

\begin{lem}\label{lem:algebras-are-sifted-colimits}
  Given a Lawvere theory $\cT$, for any functor $F : \cT \to \CSet$ the following conditions are equivalent:
  \begin{enumerate}
  \item $F$ is an algebra.
  \item $(\yon \dn F)\op$ is a sifted category.
  \item $F$ is a sifted colimit of represented algebras.
  \end{enumerate}
\end{lem}
\begin{proof}
  \textbf{(1) $\imp$ (2).}
  By \cref{cor:finite-coproducts-then-sifted} and duality, it suffices to show that $(\yon \dn F)$ has finite products.
  Since $F$ preserves finite products, $F1$ is the singleton set.
  Then by the Yoneda lemma, $\hom(\cT(\blank, 1), F) \iso F1 \iso 1$, so there is a unique natural transformation from the represented functor to $F$.
  Thus, $(1, * : \cT(\blank, 1) \to F)$ is the terminal object in $\yon \dn F$.
  Binary products are defined pointwise: $(a, \mu) \times (b, \nu)$ is defined as $(a \times b, \gamma)$, where $\gamma$ corresponds to $(x, y) \in F(a) \times F(b)$ and $x$ and $y$ correspond to $\mu$ and $\nu$ respectively under the Yoneda bijection.
  This is well-defined because $F(a) \times F(b) \iso F(a \times b)$.

  \textbf{(2) $\imp$ (3).}
  $F$ is naturally isomorphic to $\colim_{(\yon \dn F)\op}\yon\Pi_{F}$.
  Since $(\yon \dn F)\op$ is sifted, $F$ is a sifted colimit of represented algebras.

  \textbf{(3) $\imp$ (1).}
  By \cref{thm:algebraic-categories-has-sifted-colimits}, $\Alg(\cT)$ is closed under sifted colimits.
\end{proof}

\begin{thm}\label{thm:algebraic-categories-cocomplete}
  Every algebraic category is cocomplete.
\end{thm}
\begin{proof}
  It suffices to show that $\Alg(\cT)$ is cocomplete for any Lawvere theory $\cT$.
  By \cref{thm:algebraic-categories-has-sifted-colimits}, algebraic categories have sifted colimits.
  In particular, they have reflexive coequalizers.
  We can use the same argument to show that algebraic categories have filtered colimits.
  Thus, it suffices to construct finite coproducts.

  The initial object $i \in \CSet^{\cT}$ maps each object $t \in \cT$ to the empty set.
  This is also an initial object in $\Alg(\cT)$ as it preserves finite products.
  Now, consider two arbitrary algebras $F, G : \cT \toto \CSet$.
  We define
  \[
    F + G := \colim_{(\yon \dn F)\op}\yon\Pi_{F} + \colim_{(\yon \dn G)\op}\yon\Pi_{G} \iso \colim_{(\yon \dn F)\op \times (\yon \dn G)\op}\yon\Pi_{F} + \yon\Pi_{G}
  \]
  By \cref{lem:algebras-are-sifted-colimits}, the categories of elements of $F$ and $G$ are sifted, and the product of sifted categories is also sifted.
  Thus, the last colimit is an algebra by \cref{thm:algebraic-categories-has-sifted-colimits}.
\end{proof}

\begin{defn}
  A \emph{free cocompletion} of a category $\iC$ under colimits is a functor $F : \iC \to \iD$ so that
  \begin{enumerate}
  \item $\iD$ has colimits.
  \item For any functor $G : \iC \to \iE$, where $\iE$ has colimits, there is an essentially unique functor $G^{*} : \iD \to \iE$ preserving colimits with $G \iso G^{*}F$.
  \end{enumerate}
\end{defn}

\begin{thm}\label{thm:yon-free-cocomp}
  For every small category $\iC$, the Yoneda embedding $\yon : \iC \to \CSet^{\iC\op}$ is a free cocompletion under colimits.
\end{thm}
\begin{proof}
  Let $G : \iC \to \iE$ be any functor, where $\iE$ is cocomplete.
  We define $G^{*}$ as the pointwise left Kan extension computed by the colimit formula:
  \[
    G^{*}(F) := \colim\left((\yon \dn F) \xrightarrow{\Pi_{F}} \iC \xrightarrow{G} \iE\right)
  \]
  Since $\yon$ is fully faithful, $G^{*}$ is a genuine extension.
  % https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXGNUXFxvcCJdLFsxLDEsIlxcQWxnKFxcY1QpIl0sWzIsMCwiXFxpRCJdLFswLDEsIlxceW9uIiwyXSxbMCwyLCJGIl0sWzEsMiwiRl57Kn0iLDJdXQ==
  \[\begin{tikzcd}
      \iC && \iE \\
      & {\CSet^{\iC\op}}
      \arrow["\yon"', from=1-1, to=2-2]
      \arrow["G", from=1-1, to=1-3]
      \arrow["{G^{*}}"', from=2-2, to=1-3]
    \end{tikzcd}\]
  
  It remains to show that $G^{*}$ preserves colimits.
  Indeed, $G^{*}$ has a right adjoint.
  We define a functor $R : \iE \to \CSet^{\iC\op}$ by
  \[
    R : e \mapsto \iE(G\blank, e)
  \]
  We need to verify the natural isomorphism
  \[
    \iE(G^{*}F, e) = \iE(\colim G\Pi_{F}, e) \iso \CSet^{\iC\op}(F, Re) = \CSet^{\iC\op}(F, \iE(G\blank, e))
  \]
  By the represented property of colimits, we have
  \[
    \iE(\colim_{(\yon \dn F)} G\Pi_{F}, e) \iso \lim_{(\yon \dn F)\op}\iE(G\Pi_{F}, e).
  \]
  and similarly,
  \[
    \CSet^{\iC\op}(F, \iE(G\blank, e)) \iso \CSet^{\iC\op}(\colim_{(\yon \dn F)}\yon\Pi_{F}, \iE(G\blank, e)) \iso \lim_{(\yon \dn F)\op}\CSet^{\iC\op}(\yon\Pi_{F}, \iE(G\blank, e))
  \]
  Note that $F$ is contravariant so it is isomorphic to $\colim_{(\yon \dn F)}\yon\Pi_{F}$.
  By the Yoneda lemma, $\iE(G\Pi_{F}, e) \iso \CSet^{\iC\op}(\yon\Pi_{F}, \iE(G\blank, e))$.
  Thus, their limits are isomorphic.
\end{proof}

\begin{thm}\label{thm:alg-free-cocompletion}
  For every Lawvere theory $\cT$, the functor
  \[
    y : \cT\op \to \Alg(\cT),\quad~t \mapsto \cT(t,\blank)
  \]
  is a free cocompletion of $\cT\op$ under sifted colimits.
  Additionally, if a cocompletion $G : \cT\op \to \iE$ preserves coproducts, then the essentially unique extension admits a right adjoint.
\end{thm}
\begin{proof}
  For any functor $G : \cT\op \to \iE$ where $\iE$ has sifted colimits, we define $G^{*}$ as the left Kan extension of $G$ along $\yon$.
  % https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGNUXFxvcCJdLFsyLDAsIlxcaUUiXSxbMSwyLCJcXEFsZyhcXGNUKSJdLFsxLDEsIlxcQ1NldF57XFxjVH0iXSxbMCwyLCJ5IiwyLHsiY3VydmUiOjJ9XSxbMCwxLCJHIl0sWzIsMSwiR157Kn1cXGlvdGEiLDIseyJjdXJ2ZSI6Mn1dLFswLDMsIlxceW9uIiwyXSxbMywxLCJHXnsqfSIsMl0sWzIsMywiXFxpb3RhIl0sWzUsMywiXFxpc28iLDAseyJzaG9ydGVuIjp7InNvdXJjZSI6MjB9fV1d
  \[\begin{tikzcd}
      \cT\op && \iE \\
      & {\CSet^{\cT}} \\
      & {\Alg(\cT)}
      \arrow["y"', curve={height=12pt}, from=1-1, to=3-2]
      \arrow[""{name=0, anchor=center, inner sep=0}, "G", from=1-1, to=1-3]
      \arrow["{G^{*}\iota}"', curve={height=12pt}, from=3-2, to=1-3]
      \arrow["\yon"', from=1-1, to=2-2]
      \arrow["{G^{*}}"', from=2-2, to=1-3]
      \arrow["\iota", from=3-2, to=2-2]
      \arrow["\iso", shorten <=3pt, Rightarrow, from=0, to=2-2]
    \end{tikzcd}\]
  This is always possible because $\cT\op$ has finite coproducts, and so does the slice category $\cT\op \dn t$ for any $t \in \cT$.
  By \cref{cor:finite-coproducts-then-sifted}, $\cT\op \dn t$ is sifted.
  Thus, the left Kan extension can be computed by the colimit formula.
  As it turns out, $G^{*}\iota$ is a left Kan extension of $G$ along $y$ as it is also computed by the colimit formula.
  Commutativity of the diagram then implies that $G^{*}\iota$ is a genuine extension.
  
  It remains to show that $G^{*}\iota$ preserves sifted colimits.
  Consider the following natural isomorphism:
  \[
    \iE(G^{*}\iota F, e) \iso \CSet^{\cT}(\iota F, Re)
  \]
  where $F$ is an algebra.
  For any sifted diagram $D : \iS \to \Alg(\cT)$, we have
  \begin{align}
    \iE(G^{*}\iota\colim_{s \in \iS} D(s), e) &\iso \CSet^{\cT}(\iota\colim_{s \in \iS} D(s), Re)\\
                                       &\iso \CSet^{\cT}(\colim_{s \in \iS} \iota D(s), Re)\\
                                       &\iso \lim_{s \in \iS\op}\CSet^{\cT}(\iota D(s), Rd)\\
                                       &\iso \lim_{s \in \iS\op}\iE(G^{*}\iota D(s), e)\\
                                       &\iso \iE(\colim_{s \in \iS}G^{*}\iota D(s), e)
  \end{align}
  As the isomorphism holds for any $e \in \iE$, $G^{*}\iota(\colim D) \iso \colim G^{*}\iota D$ by the Yoneda lemma.
  If $G$ preserves finite coproducts, then $Re = \iE(G\blank, e)$ is an algebra.
  Thus, $\CSet^{\cT}(\colim_{s \in \iS} \iota D(s), Re) \iso \Alg(\cT)(\colim_{s \in \iS} \iota D(s), Re)$.
\end{proof}

\begin{cor}
  Every algebraic category $\iC$ is a free cocompletion of a small category with finite coproducts under sifted colimits.
\end{cor}
\begin{proof}
  By definition, every algebraic category is equivalent to $\Alg(\cT)$ for some Lawvere theory $\cT$.
  By \cref{thm:alg-free-cocompletion}, $\Alg(\cT)$ is the free cocompletion of $\cT\op$, a category with finite coproducts, under sifted colimits.
\end{proof}

\begin{cor}\label{cor:alg-reflective}
  For any algebraic theory $\cT$, $\Alg(\cT)$ is a full reflective subcategory of $\CSet^{\cT}$.
\end{cor}
\begin{proof}
  By the construction in \cref{thm:yon-free-cocomp}, the extension $y^{*}$ admits a right adjoint.
  % https://q.uiver.app/#q=WzAsMyxbMCwwLCJcXGNUXFxvcCJdLFsyLDAsIlxcQWxnKFxcY1QpIl0sWzEsMiwiXFxDU2V0XntcXGNUfSJdLFswLDEsInkiXSxbMCwyLCJcXHlvbiIsMl0sWzIsMSwieV57Kn0iLDAseyJvZmZzZXQiOi0yfV0sWzEsMiwiUiIsMCx7Im9mZnNldCI6LTJ9XSxbNSw2LCIiLDIseyJsZXZlbCI6MSwic3R5bGUiOnsibmFtZSI6ImFkanVuY3Rpb24ifX1dXQ==
  \[\begin{tikzcd}
      \cT\op && {\Alg(\cT)} \\
      \\
      & {\CSet^{\cT}}
      \arrow["y", from=1-1, to=1-3]
      \arrow["\yon"', from=1-1, to=3-2]
      \arrow[""{name=0, anchor=center, inner sep=0}, "{y^{*}}", shift left=2, from=3-2, to=1-3]
      \arrow[""{name=1, anchor=center, inner sep=0}, "R", shift left=2, from=1-3, to=3-2]
      \arrow["\dashv"{anchor=center, rotate=-37}, draw=none, from=0, to=1]
    \end{tikzcd}\]
  It suffices to show that $R$ is naturally isomorphic to the inclusion functor.
  For each $G \in \Alg(\cT)$, we have a natural isomorphism by the Yoneda lemma
  \[
    \Alg(\cT(t,\blank), G) \iso Gt
  \]
  These natural isomorphisms assemble into a natural isomorphism $\alpha : R \to \iota$.
\end{proof}

\section{Properties of algebras}
\label{sec:properties-of-algebras}

\begin{thm}\label{thm:retract-reg-reg}
  If $c$ is regular projective (resp., finitely presentable), then its retracts are regular projective (resp., finitely presentable).
\end{thm}
\begin{proof}
  Let $c'$ be a retract of $c$.
  By \cref{lem:retract-colimit-preserved}, $\iC(c',\blank)$ preserves regular epimorphisms (resp., filtered colimits) since $\iC(c,\blank)$ does.
\end{proof}

\begin{thm}\label{thm:represented-functors-perfectly-presentable}
  Let $\cT$ be a small category.
  In $\CSet^{\cT}$, the representable functors are perfectly presentable.
  If $\cT$ is a Lawvere theory, the representable functors are perfectly presentable objects in $\Alg(\cT)$.
\end{thm}
\begin{proof}
  By the Yoneda Lemma,
  \[
    \CSet^{\cT}(\cT(t,\blank), \colim_{\iJ} D) \iso (\colim_{\iJ} D)(t)
  \]
  Since colimits in $\CSet^{\cT}$ are computed objectwise, we have
  \[
    (\colim_{\iJ} D)(t) = \colim_{\iJ}(D_{j}(t)) \iso \colim_{\iJ}\CSet^{\cT}(\cT(t,\blank), D_{j})
  \]
  That is, $\CSet^{\cT}(\cT(t,\blank), \blank)$ preserves any colimit, including sifted ones.
  Thus, $\cT(t,\blank)$ is perfectly presentable in $\CSet^{\cT}$.
  If $\cT$ is a Lawvere theory, then by \cref{thm:algebraic-categories-has-sifted-colimits}, $\Alg(\cT)$ is closed under sifted colimits.
  Thus, the argument above can be restricted to $\Alg(\cT)$.
\end{proof}

\begin{thm}\label{thm:alg-pp-ret}
  In every algebraic category,
  \begin{enumerate}
  \item The perfectly presentable objects are precisely the retracts of representable algebras.
  \item The regular projective objects are precisely the retracts of coproducts of representable algebras.
  \end{enumerate}
\end{thm}
\begin{proof}
  1. By \cref{thm:represented-functors-perfectly-presentable}, representable algebras are perfectly presentable.
  By \cref{thm:retract-reg-reg}, retractions of perfectly presentable objects are perfectly presentable.
  Conversely, suppose that $F$ is a perfectly presentable algebra.
  By \cref{lem:algebras-are-sifted-colimits}, $F$ is a sifted colimit of representable algebras.
  As $\Alg(\cT)(F,F) \iso \Alg(\cT)(F,\colim\yon\Pi_{F}) \iso \colim\Alg(\cT)(F,\yon\Pi_{F}\blank)$, the identity natural transformation $\id_{F}$ determines $s : F \to \cT(t,\blank)$ so that $rs = \id_{F}$, where $r : \cT(t,\blank) \to F$ is a component of the colimiting cocone of $\colim\yon\Pi_{F}$.
  % https://q.uiver.app/#q=WzAsMyxbMiwyLCJcXGNvbGltXFxBbGcoXFxjVCkoRixcXHlvblxcUGlfe0Z9XFxibGFuaykiXSxbMCwyLCJzIFxcaW4gXFxBbGcoXFxjVCkoRixcXGlUKHQsXFxibGFuaykpIl0sWzIsMCwiXFxBbGcoXFxjVCkoRixGKSJdLFsxLDBdLFsxLDIsInIgXFxjaXJjIFxcYmxhbmsiXSxbMCwyLCJcXGlzbyIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
  \[\begin{tikzcd}
      && {\id_{F} \in \Alg(\cT)(F,F)} \\
      \\
      {s \in \Alg(\cT)(F,\cT(t,\blank))} && {\colim\Alg(\cT)(F,\yon\Pi_{F}\blank)}
      \arrow[from=3-1, to=3-3]
      \arrow["{r \circ \blank}", from=3-1, to=1-3]
      \arrow["\iso"', dashed, from=3-3, to=1-3]
    \end{tikzcd}\]
  Thus, $r$ is a retraction and $F$ is a retract of $\cT(t,\blank)$.

  2. Since regular epimorphisms are coequalizers of reflexive pairs (sifted colimits), every perfectly presentable algebra is regular projective.
  By \cref{thm:represented-functors-perfectly-presentable}, representable algebras are perfectly presentable, and by \cref{lem:pp-closed-under-coprod}, coproducts of perfectly presentable algebras are perfectly presentable algebras.
  By \cref{thm:retract-reg-reg}, the retract of this algebra is perfectly presentable; therefore, regular projective.
  Conversely, suppose that $F$ is a regular projective algebra.
  By \cref{lem:algebras-are-sifted-colimits}, $F$ can be expressed as a sifted colimit of representable algebras.
  Thus, it is a regular quotient
  \[
    \coprod\cT(t,\blank) \epi \colim\yon\Pi_{F} \xrightarrow{\iso} F
  \]
  Since $F$ is regular projective, the epimorphism $\coprod\cT(t,\blank) \epi F$ admits a section.
  % https://q.uiver.app/#q=WzAsMyxbMSwwLCJGIl0sWzIsMSwiRiJdLFswLDEsIlxcY29wcm9kXFxjVCh0LFxcYmxhbmspIl0sWzAsMSwiXFxpZCJdLFsyLDEsIiIsMix7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6ImVwaSJ9fX1dLFswLDIsIiIsMix7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
  \[\begin{tikzcd}
      & F \\
      {\coprod\cT(t,\blank)} && F
      \arrow["\id", from=1-2, to=2-3]
      \arrow[two heads, from=2-1, to=2-3]
      \arrow[dashed, from=1-2, to=2-1]
    \end{tikzcd}\]
  Thus, $F$ is a retract of a coproduct of representable algebras.
\end{proof}

\begin{cor}
  Every algebraic theory has enough regular projective objects, i.e., every algebra is a regular quotient of a regular projective algebra.
\end{cor}
\begin{proof}
  Immediate from the retraction $\coprod\cT(t,\blank) \epi F$ in \cref{thm:alg-pp-ret}.
\end{proof}

\todo{Ivan's LN3: A variety is a cocomplete category with a dense generator consisting of ``finite projective'' objects.}
\begin{thm}[Characterization of algebraic categories]\label{thm:characterization-of-algebraic-categories}
  The following conditions are equivalent:
  \begin{enumerate}
  \item $\iC$ is algebraic.
  \item $\iC$ is cocomplete and has a set $\iG$ of perfectly presentable objects such that every object of $\iC$ is a sifted colimit of objects of $\iG$.
  \item $\iC$ is cocomplete and has a strong generator $\iG$ consisting of perfectly presentable objects.
  \end{enumerate}
\end{thm}
\begin{proof}
  \textbf{(1) $\imp$ (2).}
  By definition, $\iC$ is equivalent to $\Alg(\cT)$ for some algebraic theory $\cT$.
  It suffices to show the statement for $\Alg(\cT)$.
  By \cref{thm:algebraic-categories-cocomplete}, $\Alg(\cT)$ is cocomplete.
  Let $\iG$ be the collection of all representable algebras $\cT(t,\blank)$.
  As $\cT$ is small, $\iG$ is a set.
  By \cref{thm:represented-functors-perfectly-presentable}, $\iG$ consists of perfectly presentable objects and by \cref{lem:algebras-are-sifted-colimits}, every algebra is a sifted colimit of representable functors.

  \textbf{(2) $\imp$ (3).}
  By hypothesis, $\iG$ is dense.
  By \cref{lem:colimits-strong-generators}, $\iG$ is a strong generator.

  \textbf{(3) $\imp$ (1).}
  Without loss of generality, assume that $\iG$ is closed under coproducts.
  This is justified as any coproduct completion of $\iG$ is still a strong generator by \cref{lem:srong-coprod-comp-strong}.
  Additionally, $\iG$ is dense by \cref{lem:sg-pp-dense}.
  As $\iG\op$ has finite products, it is an algebraic theory.
  Now, it suffices to show that $\iG\op$ axiomatizes $\iC$, i.e., $\Alg(\iG\op) \eqv \iC$.
  Consider the restricted Yoneda embedding $\yon_{\iG}$.
  Indeed, it defines a functor $\yon_{\iG} : \iC \to \Alg(\iG\op)$.
  By \cref{lem:realization}, $\yon_{\iG}$ is fully faithful.
  It suffices to show that $\yon_{\iG}$ is essentially surjective on objects.
  To this end, we show that $\yon_{\iG}\iota^{*}$ is naturally isomorphic to the identity, where $\iota^{*}$ is the unique extension in \cref{thm:alg-free-cocompletion}.
  Clearly, $\id$ is the essentially unique extension from $\Alg(\iG\op)$ to itself.
  Since $\iota^{*}$ preserves sifted colimits, if $\yon_{\iG}$ also preserves sifted colimits, then $\yon_{\iG}\iota^{*}$ constitutes an extension, and by uniqueness $\yon_{\iG}\iota^{*} \iso \id$.
  % https://q.uiver.app/#q=WzAsNCxbMiwwLCJcXGlDIl0sWzAsMCwiXFxpRyJdLFsxLDEsIlxcQWxnKFxcaUdcXG9wKSJdLFs0LDAsIlxcQWxnKFxcaUdcXG9wKSJdLFsxLDAsIlxcaW90YSIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzEsMiwieSIsMl0sWzIsMCwiXFxpb3RhXnsqfSIsMV0sWzAsMywiXFx5b25fe1xcaUd9Il0sWzIsMywiXFxpZCIsMl1d
  \[\begin{tikzcd}
      \iG && \iC && {\Alg(\iG\op)} \\
      & {\Alg(\iG\op)}
      \arrow["\iota", hook, from=1-1, to=1-3]
      \arrow["y"', from=1-1, to=2-2]
      \arrow["{\iota^{*}}"{description}, from=2-2, to=1-3]
      \arrow["{\yon_{\iG}}", from=1-3, to=1-5]
      \arrow["\id"', from=2-2, to=1-5]
    \end{tikzcd}\]
  Consider an arbitrary sifted colimit in $\iC$, we have
  \[
    \yon_{\iD}(\colim_{\iS}D) = \iC(\blank, \colim_{\iS}D)
  \]
  As $\iG$ consists of perfectly presentable objects, we have for each $G \in \iG$
  \[
    \iC(G,\colim_{\iS}D) \iso \colim_{\iS}\iC(G,D\blank) = \colim_{\iS}\yon_{\iG}D(G)
  \]
  Thus, $\yon_{\iG}(\colim_{\iS}D) \iso \colim_{\iS}\yon_{\iG}D$.
\end{proof}

\section{Algebraic functors}
\label{sec:algebraic-functors}

\begin{defn}
  Let $\cT_{1}$ and $\cT_{2}$ be algebraic theories.
  A \emph{morphism of algebraic theories} is a finite product preserving functor $M : \cT_{1} \to \cT_{2}$.
\end{defn}

\begin{defn}
  Let $M : \cT_{1} \to \cT_{2}$ be a morphism of algebraic theories.
  We define a functor
  \[
    \Alg(M) : \Alg(\cT_{2}) \to \Alg(\cT_{1}),\quad~G \mapsto G \circ M
  \]
  by precomposition.
\end{defn}

\begin{thm}\label{thm:algebraic-functor-left-adjoint}
  Let $M : \cT_{1} \to \cT_{2}$ be a morphism of algebraic theories.
  $\Alg(M)$ has a left adjoint $M^{*} : \Alg(\cT_{1}) \to \Alg(\cT_{2})$.
\end{thm}
\begin{proof}
  Take $M^{*}$ to be the essentially unique extension of $y^{2}M\op$ along $y_{1}$.
  As $y_{2}M\op$ preserves finite coproducts, it admits a right adjoint by \cref{thm:alg-free-cocompletion}.
  % https://q.uiver.app/#q=WzAsMyxbMiwyLCJcXEFsZyhcXGNUX3sxfSkiXSxbMiwwLCJcXEFsZyhcXGNUX3syfSkiXSxbMCwwLCJcXGNUX3sxfVxcb3AiXSxbMiwxLCJ5X3syfU1cXG9wIl0sWzEsMCwiXFxBbGcoTSkiLDAseyJvZmZzZXQiOi0yfV0sWzAsMSwiIiwwLHsib2Zmc2V0IjotMn1dLFsyLDAsInlfezF9IiwyXSxbNSw0LCIiLDAseyJsZXZlbCI6MSwic3R5bGUiOnsibmFtZSI6ImFkanVuY3Rpb24ifX1dXQ==
  \[\begin{tikzcd}
      {\cT_{1}\op} && {\Alg(\cT_{2})} \\
      \\
      && {\Alg(\cT_{1})}
      \arrow["{y_{2}M\op}", from=1-1, to=1-3]
      \arrow[""{name=0, anchor=center, inner sep=0}, "{R}", shift left=2, from=1-3, to=3-3]
      \arrow[""{name=1, anchor=center, inner sep=0}, shift left=2, from=3-3, to=1-3]
      \arrow["{y_{1}}"', from=1-1, to=3-3]
      \arrow["\dashv"{anchor=center}, draw=none, from=1, to=0]
    \end{tikzcd}\]
  It suffices to show that $R \iso \Alg(M)$.
  $R$ is defined by $G \mapsto \Alg(\cT_{2})(y_{2}M\op\blank, G)$.
  The Yoneda lemma provides for each $t \in \cT_{1}$ a natural isomorphism
  \[
    \Alg(\cT_{2})(y_{2}M\op t, G) = \Alg(\cT_{2})(\cT_{2}(\blank, Mt), G) \iso GMt
  \]
  These natural isomorphisms assemble into a natural isomorphism $R \iso \Alg(\cT_{2})$.
\end{proof}

\begin{cor}
  Let $M : \cT_{1} \to \cT_{2}$ be a morphism of algebraic theories.
  $\Alg(M)$ preserves limits and sifted colimits.
\end{cor}
\begin{proof}
  As $\Alg(M)$ is a right adjoint by \cref{thm:algebraic-functor-left-adjoint}, it preserves limits.
  Now, it suffices to show that $G \mapsto \Alg(\cT_{2})(y_{2}M\op\blank, G)$ preserves sifted colimits.
  This follows immediate from that $y_{2}M\op t$ is a representable algebra for each $t \in \cT_{1}$ and representable algebras are perfectly presentable by \cref{thm:represented-functors-perfectly-presentable}.
\end{proof}

\begin{defn}
  A functor between algebraic categories is \emph{algebraic} if it preserves limits and sifted colimits.
\end{defn}

\begin{thm}
  A functor between algebraic categories is algebraic if and only if it has a left adjoint and preserves sifted colimits.
\end{thm}
\begin{proof}
  The if direction is evident as right adjoints preserve limits.
  Assume that $F : \Alg(\cT) \to \Alg(\cS)$ is algebraic.
  We show that $F$ satisfies the solution set condition with respect to representable algebras.
  In other words,
  \[
    \Alg(\cS)(\cS(s,\blank),F\blank) : \Alg(\cT) \to \CSet
  \]
  is representable for all $s \in \cS$.
  Once we have this result, then for any algebra $H \in \Alg(\cS)$, we have
  \begin{align}
    \Alg(\cS)(H, F\blank) &\iso \Alg(\cS)(\colim \cS(s, \blank), F\blank)\\
                          &\iso \lim\Alg(\cS)(\cS(s, \blank), F\blank)\\
                          &\iso \lim\Alg(\cT)(B_{s}, \blank)\\
                          &\iso \Alg(\cT)(\colim B_{s}, \blank)
  \end{align}
  That is, the representing objects are formed by sifted colimits.

  We now show the required result.
  Since $F$ preserves limits, it suffices to check the solution set condition for each $\cS(s,\blank) \in \Alg(\cS)$.
  As each $G \in \Alg(\cS)$ is a sifted colimit that $F$ preserves and $\cS(s,\blank)$ is perfectly presentable, $\Alg(\cS)(\cS(s,\blank),FG)$ is a colimit in $\CSet$.
  Thus, every $\alpha : \cS(s,\blank) \to FG$ lies in the image of some inclusion morphism $F\sigma_{t,\mu} \circ \blank$, where $\sigma$ is the colimiting cocone of $G$.
  Thus, every $\alpha$ factors as follows
  % https://q.uiver.app/#q=WzAsMyxbMCwyLCJcXGNTKHMsXFxibGFuaykiXSxbMiwyLCJGRyJdLFsyLDAsIkYoXFxjVCh0LFxcYmxhbmspKSJdLFswLDEsIlxcYWxwaGEiLDJdLFsyLDEsIkZcXHNpZ21hX3sodCxcXG11KX0iXSxbMCwyLCJcXGdhbW1hIl1d
  \[\begin{tikzcd}
      && {F(\cT(t,\blank))} \\
      \\
      {\cS(s,\blank)} && FG
      \arrow["\alpha"', from=3-1, to=3-3]
      \arrow["{F\sigma_{(t,\mu)}}", from=1-3, to=3-3]
      \arrow["\gamma", from=3-1, to=1-3]
    \end{tikzcd}\]
  This suggests that we take the set
  \[
    \Phi := \bigcup_{t \in \cT}\Set{\gamma : \cS(s,\blank) \to F(\cT(t,\blank))}
  \]
  as the solution set.
\end{proof}

\bibliographystyle{alpha}
\bibliography{lawvere}

\end{document}
